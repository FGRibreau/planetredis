<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<title>Community Redis Aggregator</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="robots" content="index,follow" />
	<link rel="stylesheet" type="text/css" href="css/style.css" />
	<link rel="alternate" type="application/rss+xml" href="http://www.planetredis.org/rss20.xml" title="Community Redis Aggregator RSS" />
	<script src="/css/yui-combined.min.js"></script>
	<script src="/css/core.js"></script>
	<link rel="stylesheet" type="text/css" media="all" href="//fonts.googleapis.com/css?family=Ubuntu:300,400,400italic" />
</head>

<body class="blog">
<div id="wrapper" class="hfeed">

<div id="header">

<div id="orangeHeader">
	<h1>
		<a href="http://www.planetredis.org/" title="Community Redis Aggregator"><span>Community Redis Aggregator</span></a>
	</h1>
</div>

</div>

	<div id="main">
		<div id="container">
			<div id="content">



	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://antirez.com/news/88" title="Antirez weblog">Adventures in message queues</a></h2>

<h3>Antirez</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
EDIT: In case you missed it, Disque source code is now available at http://github.com/antirez/disque
<br />
<br />It is a few months that I spend ~ 15-20% of my time, mostly hours stolen to nights and weekends, working to a new system. It’s a message broker and it’s called Disque. I’ve an implementation of 80% of what was in the original specification, but still I don’t feel like it’s ready to be released. Since I can’t ship, I’ll at least blog… so that’s the story of how it started and a few details about what it is.
<br />
<br />~ First steps ~
<br />
<br />Many developers use Redis as a message queue, often wrappered via some library abstracting away Redis low level primitives, other times directly building a simple, ad-hoc queue, using the Redis raw API. This use case is covered mainly using blocking list operations, and list push operations. Redis apparently is at the same time the best and the worst system to use like that. It’s good because it is fast, easy to inspect, deploy and use, and in many environments it was already one piece of the infrastructure. However it has disadvantages because Redis mutable data structures are very different than immutable messages. Redis HA / Cluster tradeoffs are totally biased towards large mutable values, but the same tradeoffs are not the best ones to deal with messages.
<br />
<br />One thing that is important to guarantee for a message broker is that a message is delivered either at least one time, or at most one time. In short given that to guarantee an exact single delivery of a message (where for delivery we intent a message that was received *and* processed by a worker) is practically impossible, the choices are that the message broker is able to guarantee either 0 or 1 deliveries, or 1 to infinite deliveries. This is often referred as at-most-once semantics, and at-least-once semantics. There are use cases for the first, but the most interesting and practical semantics is the latter, that is, to guarantee that a message is delivered at least one time, and deliver multiple times if there are failures.
<br />
<br />So a few months ago I started to think at some client-side protocol to use a set of Redis masters (without replication or clustering whatsoever) in a way that provides these guarantees. Sometimes with small changes in the way Redis is used for an use case, it is possible to end with a better system. For example for distributed locks I tried to document an algorithm which is trivial to implement but more robust than the single-instance + failover implementation (http://redis.io/topics/distlock).
<br />
<br />However after a few days of work my design draft suggested that it was a better bet to design an ad-hoc system, since the client-side algorithm ended being too complex, non optimal, and certain things I absolutely wanted were impossible or very hard to do. To add more things to Redis sounded like a bad idea, it does a lot of things already, and to cover messaging well I needed things which are very different than the way Redis operates. But why to design a new system given that the world is full of message brokers? Because an impressive number of users were using Redis instead of systems specifically designed for this goal, and this was strange. A few can be wrong, but so many need to get some reason. Maybe Redis low barrier of entry, easy API, speed, were not what most people were accustomed to when they looked at the message brokers landscape. It seems populated by solutions that are either too simple, asking the application to do too much, or too complex, but super full featured. Maybe there is some space for the “Redis of messaging”?
<br />
<br />~ Redis brutally forked ~
<br />
<br />For the first time in my life I didn’t started straight away to write code. For weeks I looked at the design from time to time, converted it into a new system and not a Redis client library, and tried to understand, as an user, what would make me very happy in a message broker. The original use case remained the same: delayed jobs. Disque is a general system, but 90% of times in the design the “reference” was an user that has to solve the problem of sending messages that are likely jobs to process. If something was against this use case, it was removed.
<br />
<br />When the design was ready, I finally started to code. But where to start? “vi main.c”? Fortunately Redis is, in part, a framework to write distributed systems in C. I had a protocol, network libraries, clients handling, node-to-node message bus. To rewrite all this from scratch sounded like a huge waste. At the same time I wanted Disque to be able to completely diverge from Redis in any details possible if this is needed, and I wanted it to be a side project without impacts on Redis itself. So instead of trying the huge undertake of splitting Redis into an actual separated framework, and the Redis implementation, I took a more pragmatic approach: I forked the code, and removed everything that was Redis specific from the source code, in order to end with a skeleton. At this point I was ready to implement my specification.
<br />
<br />~ What is Disque? ~
<br />
<br />After a few months of very non intense work and just 200 commits I’ve finally a system that no longer looks like a toy: it looked like a toy for many weeks so I was afraid of even talking about it, since the probability of me just deleting the source tree was big. Now that most of the idea is working code with tests, I’m finally sure this will be released in the future, and to talk about the tradeoffs I took in the design.
<br />
<br />Disque is a distributed system, by default. Since it is an AP system, it made no sense to have like in Redis a single-node mode and a distributed mode. A single Disque node is just a particular case of a cluster, having just one node.
<br />So this was of the important points in the design: fault tolerant, resistant to partitions, and available no matter how many nodes are still up, aka AP. I also wanted a system that was inherently able to scale in different scenarios, both when the issue is many producers and consumers with many queues, and when instead all this producers and consumers are all focusing on a single queue, that may be distributed into multiple nodes.
<br />
<br />My requirements were telling me aloud one thing… that Disque was going to make a big design sacrifice. Message ordering. Disque only provides best-effort ordering. However because of this sacrifice, there is a lot to gain… tradeoffs are interesting since sometimes they totally open the design space.
<br />
<br />I could continue recounting you what Disque is like that, however a few months ago I saw a comment in Hacker News, written by Jacques Chester, see https://news.ycombinator.com/item?id=8709146 [EDIT: SORRY I made an error cut&amp;pasting the wrong name of Adrian (Hi Adrian, sorry for misquoting you!)]. Jacques, that happens to work for Pivotal like me, was commenting how different messaging systems have very different set of features, properties, and without the details it is almost impossible to evaluate the different choices, and to evaluate if one is faster than the other because it has a better implementation, or simple offers a lot less guarantees. So he wrote a set of questions one should ask when evaluating a messaging system. I’ll use his questions, and add a few more, in order to describe what Disque is, in the hope that I don’t end just hand waving, but providing some actual information.
<br />
<br />Q: Are messages delivered at least once?
<br />
<br />In Disque you can chose at least once delivery (the default), or at most once delivery. This property can be set per message. At most once delivery is just a special case of at least once delivery, setting the “retry” parameter of the message to 0, and replicating the message to a single node.
<br />
<br />Q: Are messages acknowledged by consumers?
<br />
<br />Yes, the only way for a consumer to tell the system the message got delivered correctly, is to acknowledge it.
<br />
<br />Q: Are messages delivered multiple times if not acknowledged?
<br />
<br />Yes, Disque will automatically deliver the message again, after a “retry” time, forever (up to the max TTL time for the message).
<br />When messages are acknowledged, the acknowledge is propagated to the nodes having a copy of the message. If the system believes everybody was reached, the message is finally garbage collected and removed. Acknowledged messages are also evicted during memory pressure.
<br />
<br />Nodes run a best-effort algorithm to avoid to queue the same message multiple times, in order to approximate single delivery better. However during failures, multiple nodes may re-deliver the same message multiple times at the same time.
<br />
<br />Q: Is queueing durable or ephemeral.
<br />
<br />Durable.
<br />
<br />Q: Is durability achieved by writing every message to disk first, or by replicating messages across servers?
<br />
<br />By default Disque runs in-memory only, and uses synchronous replication to achieve durability (however you can ask, per message, to use asynchronous replication). It is possible to turn AOF (similarly to Redis) if desired, if the setup is likely to see a mass-reboot or alike. When the system is upgraded it is possible to write the AOF on disk just for the upgrade in order to don’t lose the state after a restart even if normally disk persistence is not used.
<br />
<br />Q: Is queueing partially/totally consistent across a group of servers or divided up for maximal throughput?
<br />
<br />Divided up for throughput, however message ordering is preserved in a best-effort way. Each message has an immutable “ctime” which is a wall-clock milliseconds timestamp plus an incremental ID for messages generated in the same millisecond. Nodes use this ctime in order to sort messages for delivery.
<br />
<br />Q: Can messages be dropped entirely under pressure? (aka best effort)
<br />
<br />No, however new messages may be refused if there is no space in memory. When 75% of memory is in use, nodes receiving messages try to externally replicate them, just to outer nodes, without taking a copy, but it many not work if also the other nodes are in an out of memory condition.
<br />
<br />Q: Can consumers and producers look into the queue, or is it totally opaque?
<br />
<br />There are commands to “PEEK” into queues.
<br />
<br />Q: Is queueing unordered, FIFO or prioritised?
<br />
<br />Best-effort FIFO-ish as explained.
<br />
<br />Q: Is there a broker or no broker?
<br />
<br />Broker as a set of masters. Clients can talk to whatever node they want.
<br />
<br />Q: Does the broker own independent, named queues (topics, routes etc) or do producers and consumers need to coordinate their connections?
<br />
<br />Named queues. Producers and consumers does not need to coordinate, since nodes use federation to discover routes inside the cluster and pass messages as they are needed by consumers. However the client is provided with hints in case it is willing to relocate where more consumers are.
<br />
<br />Q: Is message posting transactional?
<br />
<br />Yes, once the command to add a message returns, the system guarantees that there are the desired number of copies inside the cluster.
<br />
<br />Q: Is message receiving transactional?
<br />
<br />I guess not, since Disque will try to deliver the same message again if not acknowledged.
<br />
<br />Q: Do consumers block on receive or can they check for new messages?
<br />
<br />Both behaviors are supported, by default it blocks.
<br />
<br />Q: Do producers block on send or can they check for queue fullness? 
<br />
<br />The producer may ask to get an error when adding a new message if the message length is already greater than a specified value in the local node it is pushing the message.
<br />
<br />Moreover the producer may ask to replicate the message asynchronously if it want to run away ASAP and let the cluster replicate the message in a best-effort way.
<br />
<br />There is no way to block the consumer if there are too many messages in the queue, and unblock it as soon as there are less messages.
<br />
<br />Q: Are delayed jobs supported?
<br />
<br />Yes, with second granularity, up to years. However they’ll use memory.
<br />
<br />Q: Can consumers and producers connect to different nodes?
<br />
<br />Yes.
<br />
<br />I hope with this post Disque is a bit less vaporware. Sure, without looking at the code it is hard to tell, but if your best feature is out you can already complain at least.
<br />How much of the above is already implemented and working well? Everything but AOF disk persistence, and a few minor things I want to refine in the API, so first release should not be too far, but working at it so rarely it is hard to get super fast.
<a href="http://antirez.com/news/88">Comments</a>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://antirez.com/news/88"> on June 03, 2015 01:40 AM</a></span>
		</div>
	</div><!-- .post -->

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://antirez.com/news/87" title="Antirez weblog">Redis Conference 2015</a></h2>

<h3>Antirez</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
I’m back home, after a non easy trip, since to travel from San Francisco to Sicily is kinda NP complete: there are no solutions involving less than three flights. However it was definitely worth it, because the Redis Conference 2015 was very good, SF was wonderful as usually and I was able to meet with many interesting people. Here I’ll limit myself to writing a short account of the conference, but the trip was also an incredible experience because I discovered old and new friends, that are not just smart programmers, but also people I could imagine being my friends here in Sicily. I never felt alone while I was 10k kilometers away from my home.
<br />
<br />The conference was organized by RackSpace in a magistral way, with RedisLabs, Heroku, and Hulu, sponsoring it as well. I can’t say thank you enough times to everybody. Many people traveled from different parts of US and outside US to SF just for a couple of days, the venue was incredibly cool, and everything organized in the finest details.
<br />
<br />There was even an incredible cake for the Redis 6th birthday :-)
<br />
<br />However the killer features of the conference were, the number and the quality of the attenders (mostly actual Redis users), around 250 people, and the quality of the talks. The conference was free, even if it did not looked like a free conference at all, at any level. An incredible stage where to talk, very high quality food, plenty of space. All this honestly helped to create a setup for interesting exchanges. Everybody was using Redis for something, to get actual things done, and a lot of people shared their experiences. Among the talks I found Hulu and Heroku ones extremely interesting, because they covered details about different use cases and operational challenges. I also happen to agree with Bill Andersen (from RackSpace) vision on benchmarking Redis in a use-case oriented fashion, even if I missed the initial part of his talk because I was being interviewed, but the cool thing is, there will be recordings of the talks, so it will be possible for everybody to watch them when available at the conf site, which is, http://redisconference.com
<br />
<br />I was approached by several VeryLargeCompanies recounting stories of how they are using or are going to use Redis to do VeryLargeUseCase. Basically at this point Redis is everywhere.
<br />
<br />Redis Conference was a big gift to the Redis community… and in some way it shows very well how much there is a Redis outside Redis, I mean, at this point it has a life outside the borders of the server and client libraries repositories. It is a technology with many users that exchange ideas and that work with it in different ways: internally to companies to provide it as a technology to cover a number of use cases, and also in the context of cloud providers, that are providing it as a service to other companies.
<br />
<br />One thing I did not liked was Matt Stancliff talk. He tried to uncover different problems in the Redis development process, and finally proposed the community to replace me as the project leader, with him. In my opinion what Matt actually managed to do was to cherry-pick from my IRC, Twitter and Github issues posts in a very unfair way, in order to provide a bad imagine of myself. I think this was a big mistake. Moreover he did the talk as the last talk, not providing a right to reply. Matt and I happen to be persons with very different visions in many ways, however Redis is a project I invested many years into, and I’m not going to change my vision, I’m actually afraid I merged some code under pressure that I now find non well written and designed.
<br />
<br />What prevents Redis for becoming a monoculture is its license, if the community at some point really believes it is possible to do much better, or simply to do things in a very different way, some forks will appear, and darwinian selection will work to make sure we have the best Redis possible. Technical leadership is a reward for the work you are capable to do, is not asked at conferences. Moreover technology is not just code, is also about human interactions, and life is too short to interact with people we don’t share the same fundamental values of what a good behavior is.
<br />
<br />Well, even if this left some bitter taste, overall the Redis Conference was a magical experience, and even Matt talk actually helped me to understand what to do in the future and what I want for this project. Thank you to who made it possible and to all the attenders, I hope to see you again next year.
<a href="http://antirez.com/news/87">Comments</a>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://antirez.com/news/87"> on June 03, 2015 01:40 AM</a></span>
		</div>
	</div><!-- .post -->

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://antirez.com/news/86" title="Antirez weblog">Side projects</a></h2>

<h3>Antirez</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
Today Redis is six years old. This is an incredible accomplishment for me, because in the past I switched to the next thing much faster. There are things that lasted six years in my past, but not like Redis, where after so much time, I still focus most of my everyday energies into.
<br />
<br />How did I stopped doing new things to focus into an unique effort, drastically monopolizing my professional life? It was a too big sacrifice to do, for an human being with a limited life span. Fortunately I simply never did this, I never stopped doing new things.
<br />
<br />If I look back at those 6 years, it was an endless stream of side projects, sometimes related to Redis, sometimes not.
<br />
<br />1) Load81, children programming environment.
<br />2) Dump1090, software defined radio ADS-B decoder.
<br />3) A Javascript ray tracer.
<br />4) lua-cmsgpack, C implementation of msgpack for Lua.
<br />5) linenoise line editing library. Used in Redis, but well, was not our top priority.
<br />6) lamernews, Redis-based HN clone.
<br />7) Gitan, a small Git web interface.
<br />8) shapeme, images evolver using simulated annealing.
<br />9) Disque, a distributed queue (work in progress right now).
<br />
<br />And there are much more throw-away projects not listed here.
<br />The interesting thing is that many of the projects listed above are not random hacking efforts that had as an unique goal to make me happy. A few found their way into other people’s code.
<br />
<br />Because of the side projects, I was able to do different things when I was stressed and impoverished from doing again and again the same thing. I could later refocus on Redis, and find again the right motivations to have fun with it, because small projects are cool, but to work for years at a single project can provide more value for others in the long run.
<br />
<br />So currently I’m using something like 20% of my time to hack on Disque, a distributed message queue. So only 80% is left for Redis development, right? Wrong. The deal is between 80% of focus on Redis and 20% on something else, or 0% of focus on Redis in the long term, because in order to have a long term engagement, you need a long term alternative to explore new things.
<br />
<br />Side projects are the projects making your bigger projects possible. Moreover they are often the start of new interesting projects. Redis itself was a side project of LLOOGG. Sometimes you stop working at your main project because of side projects, but when this happens it is not because your side project captured your focus, it is because you managed to find a better use for your time, since the side project is more important, interesting, and compelling than the main project.
<br />
<br />Redis is six years old today, but is aging well: it continues to capture the attention of more developers, and it continues to improve in order to provide a bit more value to users every week. However for me, more users, more pull requests, and more pressure, does not mean to change my setup. What Redis is today is the sum of the work we put into it, and the endurance in the course of six years. To continue along the same path, I’ll make sure to have a few side projects for the next years.
<br />
<br />UPDATE: Damian Janowski provided an incredible present for the Redis community today, the renewed Redis.io web site is online now! http://redis.io. Thanks Damian!
<br />
<br />HN comments here: https://news.ycombinator.com/item?id=9112250
<a href="http://antirez.com/news/86">Comments</a>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://antirez.com/news/86"> on June 03, 2015 01:40 AM</a></span>
		</div>
	</div><!-- .post -->

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://antirez.com/news/85" title="Antirez weblog">Why we don’t have benchmarks comparing Redis with other DBs</a></h2>

<h3>Antirez</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
Redis speed could be one selling point for new users, so following the trend of comparative “advertising” it should be logical to have a few comparisons at Redis.io. However there are two problems with this. One is of goals: I don’t want to convince developers to adopt Redis, we just do our best in order to provide a suitable product, and we are happy if people can get work done with it, that’s where my marketing wishes end. There is more: it is almost always impossible to compare different systems in a fair way.
<br />
<br />When you compare two databases, to get fair numbers, they need to share *a lot*: data model, exact durability guarantees, data replication safety, availability during partitions, and so forth: often a system will score in a lower way than another system since it sacrifices speed to provide less “hey look at me” qualities but that are very important nonetheless. Moreover the testing suite is a complex matter as well unless different database systems talk the same exact protocol: differences in the client library alone can contribute for large differences.
<br />
<br />However there are people that beg to differ, and believe comparing different database systems for speed is a good idea anyway. For example, yesterday a benchmark of Redis and AerospikeDB was published here: http://lynnlangit.com/2015/01/28/lessons-learned-benchmarking-nosql-on-the-aws-cloud-aerospikedb-and-redis/.
<br />
<br />I’ll use this benchmark to show my point about how benchmarks are misleading beasts. In the benchmark huge EC2 instances are used, for some strange reason, since the instances are equipped with 244 GB of RAM (!). Those are R3.8xlarge instances. For my tests I’ll use a more real world m3.medium instance.
<br />
<br />Using such a beast of an instance Redis scored, in the single node case, able to provide 128k ops per second. My EC2 instance is much more limited, testing from another EC2 instance with Redis benchmark, not using pipelining, and with the same 100 bytes data size, I get 32k ops/sec, so my instance is something like 4 times slower, in the single process case.
<br />
<br />Let’s see with Redis INFO command how the system is using the CPU during this benchmark:
<br />
<br /># CPU
<br />used_cpu_sys:181.78
<br />used_cpu_user:205.05
<br />used_cpu_sys_children:0.12
<br />used_cpu_user_children:0.87
<br />127.0.0.1:6379> info cpu
<br />
<br />… after 10 seconds of test …
<br />
<br /># CPU
<br />used_cpu_sys:184.52
<br />used_cpu_user:206.42
<br />used_cpu_sys_children:0.12
<br />used_cpu_user_children:0.87
<br />
<br />Redis spent ~ 3 seconds of system time, and only ~ 1.5 seconds in user space. What happens here is that for each request the biggest part of the work is to perform the read() and write() call. Also since it’s one-query one-reply workload for each client, we pay a full RTT for each request of each client.
<br />
<br />Now let’s check what happens if I use pipelining instead, a feature very known and much exploited by Redis users, since it’s the only way to maximize the server usage, and there are usually a number of places in the application where you can perform multiple operations at a given time.
<br />
<br />With a pipeline of 32 operations the numbers changed drastically. My tiny instance was able to deliver 250k ops/sec using a single core, which is 25% of the *top* result using 32 (each faster) cores in the mentioned benchmark.
<br />
<br />Let’s look at the CPU time:
<br />
<br /># CPU
<br />used_cpu_sys:189.16
<br />used_cpu_user:216.46
<br />used_cpu_sys_children:0.12
<br />used_cpu_user_children:0.87
<br />127.0.0.1:6379> info cpu
<br />
<br />… after 10 seconds of test …
<br />
<br /># CPU
<br />used_cpu_sys:190.60
<br />used_cpu_user:224.92
<br />used_cpu_sys_children:0.12
<br />used_cpu_user_children:0.87
<br />
<br />This time we are actually using the database engine to serve queries with our CPU, we are not just losing much of the time context switching. We used ~1.5 seconds of system time, and 8.46 seconds into the Redis process itself.
<br />
<br />Using lower numbers in the pipeline gets us results in the middle. Pipeline of 4 = 100k ops/sec (that should translate to ~ 400k ops/sec in the bigger instance used in the benchmark), pipeline 8 = 180k ops/sec, and so forth.
<br />
<br />So basically it is not a coincidence that benchmarking Redis and AerospikeDB in this way we get remarkably similar results. More or less you are not testing the databases, but the network stack and the kernel. If the DB can serve queries using a read and a write system call without any other huge waste, this is what we get, and here the time to serve the actual query is small since we are talking about data fitting into memory (just a note, 10M keys of 100k in Redis will use a fraction of the memory that was allocated in those instances).
<br />
<br />However there is more about that. What about the operations we can perform? To test Redis doing GET/SET is like to test a Ferrari checking how good it is at cleaning the mirror when it rains.
<br />
<br />A fundamental part of the Redis architecture is that largely different operations have similar costs, so what about our huge Facebook game posting scores of the finished games to create the leaderboard?
<br />
<br />The same single process can do 110k ops/sec when the query is: ZADD myscores  .
<br />
<br />But let’s demand more, what about estimating the cardinality with the HyperLogLog, at the same time adding new elements and reading the current guess with two redis-benchmark processes? Set size is 10 millions again. So during this test I spawned a benchmark executing PFADD with random elements of the set, and another doing PFCOUNT at the same time in the same HyperLogLog. Both scored simultaneously at 250k ops/sec, for a total of half a million ops per second with a single Redis process.
<br />
<br />In Redis doing complex operations is similar to pipelining. You want to do *more* for each read/write, otherwise your performance is dominated by I/O.
<br />
<br />Ok, so a few useful remarks. 1) GET/SET Benchmarks are not a great way to compare different database systems. 2) A better performance comparison is by use case. You say, for a given specific use case, using different data model, schema, queries, strategies, how much instances I need to handle the same traffic for the same app with two different database systems? 3) Test with instance types most people are going to actually use, huge instance types can mask inefficiencies of certain database systems, and is anyway not what most people are going to use.
<br />
<br />We’ll continue to optimize Redis for speed, and will continue to avoid posting comparative benchmarks.
<br />
<br />[Thanks to Amazon AWS for providing me free access to EC2]
<a href="http://antirez.com/news/85">Comments</a>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://antirez.com/news/85"> on June 03, 2015 01:40 AM</a></span>
		</div>
	</div><!-- .post -->

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://antirez.com/news/84" title="Antirez weblog">Redis latency spikes and the Linux kernel: a few more details</a></h2>

<h3>Antirez</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
Today I was testing Redis latency using m3.medium EC2 instances. I was able to replicate the usual latency spikes during BGSAVE, when the process forks, and the child starts saving the dataset on disk. However something was not as expected. The spike did not happened because of disk I/O, nor during the fork() call itself.
<br />
<br />The test was performed with a 1GB of data in memory, with 150k writes per second originating from a different EC2 instance, targeting 5 million keys (evenly distributed). The pipeline was set to 4 commands. This translates to the following command line of redis-benchmark:
<br />
<br />    ./redis-benchmark -P 4 -t set -r 5000000 -n 1000000000
<br />
<br />Every time BGSAVE was triggered, I could see ~300 milliseconds latency spikes of unknown origin, since fork was taking 6 milliseconds. Fortunately Redis has a software watchdog feature, that is able to produce a stack trace of the process during a latency event. It’s quite a simple trick but works great: we setup a SIGALRM to be delivered by the kernel. Each time the serverCron() function is called, the scheduled signal is cleared, so actually Redis never receives it if the control returns fast enough to the Redis process. If instead there is a blocking condition, the signal is delivered by the kernel, and the signal handler prints the stack trace.
<br />
<br />Instead of getting stack traces with the fork call, the process was always blocked near MOV* operations happening in the context of the parent process just after the fork. I started to develop the theory that Linux was “lazy forking” in some way, and the actual heavy stuff was happening later when memory was accessed and pages had to be copy-on-write-ed.
<br />
<br />Next step was to read the fork() implementation of the Linux kernel. What the system call does is indeed to copy all the mapped regions (vm_area_struct structures). However a traditional implementation would also duplicate the PTEs at this point, and this was traditionally performed by copy_page_range(). However something changed… as an optimization years ago: now Linux does not just performs lazy page copying, as most modern kernels. The PTEs are also copied in a lazy way on faults. Here is the top comment of copy_range_range():
<br />
<br />         * Don't copy ptes where a page fault will fill them correctly.
<br />         * Fork becomes much lighter when there are big shared or private
<br />         * readonly mappings. The tradeoff is that copy_page_range is more
<br />         * efficient than faulting.
<br />
<br />Basically as soon as the parent process performs an access in the shared regions with the child process, during the page fault Linux does the big amount of work skipped by fork, and this is why I could see always a MOV instruction in the stack trace.
<br />
<br />While this behavior is not good for Redis, since to copy all the PTEs in a single operation is more efficient, it is much better for the traditional use case of fork() on POSIX systems, which is, fork()+exec*() in order to spawn a new process.
<br />
<br />This issue is not EC2 specific, however virtualized instances are slower at copying PTEs, so the problem is less noticeable with physical servers.
<br />
<br />However this is definitely not the full story. While I was testing this stuff in my Linux box, I remembered that using the libc malloc, instead of jemalloc, in  certain conditions I was able to measure less latency spikes in the past. So I tried to check if there was some relation with that.
<br />
<br />Indeed compiling with MALLOC=libc I was not able to measure any latency in the physical server, while with jemalloc I could observe the same behavior observed with the EC2 instance. To understand better the difference I setup a test with 15 million keys and a larger pipeline in order to stress more the system and make more likely that page faults of all the mmaped regions could happen in a very small interval of time. Then I repeated the same test with jemalloc and libc malloc:
<br />
<br />bare metal, 675k/sec writes to 15 million keys, jemalloc: max spike 339 milliseconds.
<br />bare metal, 675k/sec writes to 15 million keys, malloc: max spike 21 milliseconds.
<br />
<br />I quickly tried to replicate the same result with EC2, same stuff, the spike was a fraction with malloc.
<br />
<br />The next logical thing after this findings is to inspect what is the difference in the memory layout of a Redis system running with libc malloc VS one running with jemalloc. The Linux proc filesystem is handy to investigate the process internals (in this case I used /proc//smaps file).
<br />
<br />Jemalloc memory is allocated in this region:
<br />
<br />7f8002c00000-7f8062400000 rw-p 00000000 00:00 0
<br />Size:            1564672 kB
<br />Rss:             1564672 kB
<br />Pss:             1564672 kB
<br />Shared_Clean:          0 kB
<br />Shared_Dirty:          0 kB
<br />Private_Clean:         0 kB
<br />Private_Dirty:   1564672 kB
<br />Referenced:      1564672 kB
<br />Anonymous:       1564672 kB
<br />AnonHugePages:   1564672 kB
<br />Swap:                  0 kB
<br />KernelPageSize:        4 kB
<br />MMUPageSize:           4 kB
<br />Locked:                0 kB
<br />VmFlags: rd wr mr mw me ac sd
<br />
<br />While libc big region looks like this:
<br />
<br />0082f000-8141c000 rw-p 00000000 00:00 0                                  [heap]
<br />Size:            2109364 kB
<br />Rss:             2109276 kB
<br />Pss:             2109276 kB
<br />Shared_Clean:          0 kB
<br />Shared_Dirty:          0 kB
<br />Private_Clean:         0 kB
<br />Private_Dirty:   2109276 kB
<br />Referenced:      2109276 kB
<br />Anonymous:       2109276 kB
<br />AnonHugePages:         0 kB
<br />Swap:                  0 kB
<br />KernelPageSize:        4 kB
<br />MMUPageSize:           4 kB
<br />Locked:                0 kB
<br />VmFlags: rd wr mr mw me ac sd
<br />
<br />Looks like here there are a couple different things.
<br />
<br />1) There is [heap] in the first line only for libc malloc.
<br />2) AnonHugePages field is zero for libc malloc but is set to the size of the region in the case of jemalloc.
<br />
<br />
<br />Basically, the difference in latency appears to be due to the fact that malloc is using transparent huge pages, a kernel feature that allows to transparently glue multiple normal 4k pages into a few huge pages, which are 2048k each. This in turn means that copying the PTEs for this regions is much faster.
<br />
<br />
<br />EDIT: Unfortunately I just spotted that I'm totally wrong, the huge pages apparently are only used by jemalloc: I just mis-read the outputs since this seemed so obvious. So on the contrary, it appears that the high latency is due to the huge pages thing for some unknown reason. So actually it is malloc that, while NOT using huge pages, is going much faster. I've no idea about what is happening here, so please disregard the above conclusions.
<br />
<br />
<br />Meanwhile for low latency applications you may want to build Redis with “make MALLOC=libc”, however make sure to use “make distclean” before, and be aware that depending on the work load, libc malloc suffers fragmentation more than jemalloc.
<br />
<br />
<br />More news soon…
<br />
<br />EDIT2: Oh wait... since the problem is huge pages, this is MUCH better, since we can disable it. And I just verified that it works:
<br />
<br />echo never > /sys/kernel/mm/transparent_hugepage/enabled
<br />
<br />This is the new Redis mantra apparently.
<br />
<br />UPDATE: While this seemed unrealistic to me, I experimentally verified that the huge pages memory spike is due to the fact that with 50 clients writing at the same time, with N queued requests each, the Redis process can touch in the space of *a single event loop iteration* all the process pages, so its copy-on-writing the entire process address space. This means that not only huge pages are horrible for latency, but that are also horrible for memory usage.
<a href="http://antirez.com/news/84">Comments</a>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://antirez.com/news/84"> on June 03, 2015 01:40 AM</a></span>
		</div>
	</div><!-- .post -->

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://blog.pivotal.io/big-data-pivotal/features/6-free-technical-classes-from-pivotal-education" title="Pivotal P.O.V. » Redis">6 Free Technical Classes From Pivotal Education</a></h2>

<h3>Pivotal</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><img class="alignleft wp-image-33049 size-full" src="http://blog.pivotal.io/wp-content/uploads/2015/06/sfeatured-pivotal-education-free.png" alt="sfeatured-pivotal-education-free" width="440" height="220" />Pivotal Education makes it easy to fully realize the capabilities of our technologies by offering a series of free introductory training courses. Ideal for developers, system architects, and data practitioners, these online courses engage students through a hands-on, sandbox lab environment and provide a technical foundation for more advanced topics taught in other Pivotal courses. The offerings are also uniquely designed to enable technologists at any point of engagement with Pivotal—whether during evaluation or after deployment—to become more well-versed, efficient, and effective in their efforts.</p>
<p>Our free, introductory training classes span across a wide array of Pivotal technologies, including:  <a href="http://pivotal.io/big-data/pivotal-hd" target="_blank">Pivotal HD</a>, <a href="http://pivotal.io/platform-as-a-service/pivotal-cloud-foundry" target="_blank">Pivotal Cloud Foundry</a>, <a href="http://pivotal.io/big-data/pivotal-greenplum-database" target="_blank">Pivotal Greenplum Database</a>, Pivotal <a href="http://pivotal.io/big-data/pivotal-hawq" target="_blank">HAWQ</a>, <a href="http://redis.io/" target="_blank">Redis</a>, and <a href="http://pivotal.io/big-data/pivotal-gemfire" target="_blank">Pivotal GemFire</a>.</p>
<p><strong><a href="http://pivotal.io/training#introduction-to-greenplum-database" target="_blank">Intro to Pivotal Greenplum Database</a></strong><br />
This course is designed to provide an introduction to students new to Pivotal Greenplum Database (GPDB). As a one day course, students will gain a high level overview of features found in GPDB. This introduction will serve as a foundation for further courses that are offered for administrators, DBAs and end users of GPDB.</p>
<p><strong><a href="http://pivotal.io/training#introduction-to-gemfire" target="_blank">Intro to GemFire</a></strong><br />
This course is designed to provide an introduction to students new to Pivotal GemFire. As a 1 day course, students will gain a high level overview of features found in GemFire. This introduction will serve as a foundation for further courses that are offered for administrator, developers and architects using GemFire. Some basic high level lab exercises are also offered to enhance the learning experience.</p>
<p><strong><a href="http://pivotal.io/training#introduction-to-pivotal-hd" target="_blank">Intro to Pivotal HD</a></strong><br />
This course is designed to provide an introduction to students new to the advanced analytic capabilities of Pivotal HD, our <a href="https://hadoop.apache.org/" target="_blank">Apache Hadoop®</a> distribution. As a one day course, students will gain a high level overview of features found in the Pivotal HD. This introduction will serve as a foundation for further courses that are offered for administrators and architects using Pivotal HD.</p>
<p><strong><a href="http://pivotal.io/training#ntroduction-to-pivotal-hd-and-hawq" target="_blank">Intro to Pivotal HAWQ</a></strong><br />
This course is designed to provide an introduction to students new to running SQL on Hadoop®. In this one day course, students will gain a high level overview of features found in HAWQ. This introduction will serve as a foundation for further courses that are offered for administrators, architects and end users of HAWQ.</p>
<p><strong><a href="http://pivotal.io/training#enterprise-paas" target="_blank">Intro to Pivotal Cloud Foundry</a></strong><br />
This course provides students with the concepts and hands-on experience needed to work with and deploy applications on Pivotal Cloud Foundry. Students will gain familiarity in general Cloud Foundry concepts (applications, buildpacks, manifests, organizations, spaces, users, roles, domains, routes, services), how to push applications to Cloud Foundry in various languages, services, user provided services, manifests, YAML, environment variables, autoconfiguration, logging and loggregator.</p>
<p><strong><a href="http://pivotal.io/training#introduction-to-redis" target="_blank">Intro to Redis (2 day course)</a></strong><br />
This hands-on course provides a broad overview of the Redis NoOSQL datastore, starting with an explanation of product functionality and typical use cases. Students will learn how to install and configure Redis, and examine some of the common commands for manipulating data. They will have the opportunity to create a simple Redis Java application, and review tips and techniques for improving performance. The course explains the use of persistence and replication in Redis, and also includes coverage of some administrative topics such as security and monitoring.</p>
<p>Whether you are evaluating Pivotal’s products for your company, have already deployed these technologies, or are a student training looking to expand your skillset, Pivotal Education courses present an opportunity to become well-versed in these topics with minimal time commitment and no financial cost.</p>
<p><a href="http://pivotal.io/training" target="_blank"><b>Learn more about Pivotal’s Education and Training Courses</b></a></p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://blog.pivotal.io/big-data-pivotal/features/6-free-technical-classes-from-pivotal-education"> on June 01, 2015 10:21 PM</a></span>
		</div>
	</div><!-- .post -->

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://blog.pivotal.io/big-data-pivotal/products/pivotal-data-roadshow-a-view-from-the-road" title="Pivotal P.O.V. » Redis">Pivotal Data Roadshow: A View From the Road</a></h2>

<h3>Pivotal</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><img class="alignleft size-full wp-image-11895" src="http://blog.pivotal.io/wp-content/uploads/2015/04/featured-BigDataRoadshow.png" alt="featured-BigDataRoadshow" width="200" height="200" />People in the market are hungry for hands-on experience and training with big data technologies.  We are seeing this through the dramatic response to the <a title="Pivotal Data Roadshow" href="https://pivotal.io/big-data/data-roadshow" target="_blank">Pivotal Data Roadshow</a>, which is touring cities across North America this month.  We have been packing the house with nearly 100 participants in each city.  We think this is a good gauge of just how much Apache HadoopⓇ and <a title="SQL on Hadoop" href="http://pivotal.io/big-data/hadoop/sql-on-hadoop" target="_blank">SQL on Hadoop</a> have been embraced within the enterprise to handle big data storage and analytics workloads.</p>
<p>Big Data technology continues to advance quickly. Just 18 months ago, Pivotal released the world’s first closed-loop platform for analytics and data-driven applications. While big data and <a title="Apache HadoopⓇ" href="http://hadoop.apache.org" target="_blank">Apache HadoopⓇ</a> were moving from niche concerns to tech buzzword status, Pivotal was merging HadoopⓇ with <a title="HAWQ" href="http://pivotal.io/big-data/pivotal-hawq" target="_blank">HAWQ</a>, a robust SQL-on-Hadoop engine, and with real time and <a title="in-memory data processin" href="http://pivotal.io/big-data/pivotal-gemfire" target="_blank">in-memory data processing</a> to round out our vision of how companies should operationalize big data over a <a title="Business Data Lake" href="http://pivotal.io/big-data/businessdatalake" target="_blank">Business Data Lake</a>. It is exciting for us to learn from the roadshows that enterprises are now eagerly embracing SQL-on-Hadoop and in-memory processing technologies to solve business problems, substantiating Pivotal’s strategy and investments over the past five years.</p>
<p>Attendees of the Pivotal Data Roadshows have included executives, administrators and operations staff, developers, data scientists, and even college students. This variety demonstrates the enormous impact these technologies have on entire industries today and how important they are to each of their futures. Many people in our audiences have already been leveraging our Data Lake solutions as <a title="Pivotal Big Data Suite" href="http://pivotal.io/big-data/pivotal-big-data-suite" target="_blank">Pivotal Big Data Suite</a> customers. These attendees have been impressed by <a title="new customer-centric entitlements" href="http://blog.pivotal.io/big-data-pivotal/news-2/pivotal-big-data-suite-open-agile-cloud-ready" target="_blank">new customer-centric entitlements</a> within the Pivotal Big Data Suite, which includes an instance of <a title="Pivotal Cloud Foundry" href="http://pivotal.io/platform-as-a-service/pivotal-cloud-foundry" target="_blank">Pivotal Cloud Foundry</a>, as well as powerful new additions for real time data ingestion and analysis via tools such as <a title="Spring XD" href="http://blog.pivotal.io/pivotal/products/spring-xd-for-real-time-analytics" target="_blank">Spring XD </a>and <a title="Redis" href="http://blog.pivotal.io/pivotal/case-studies-2/using-redis-at-pinterest-for-billions-of-relationships" target="_blank">Redis</a>.</p>
<p><img class="alignnone size-full wp-image-11897" src="http://blog.pivotal.io/wp-content/uploads/2015/04/image011.png" alt="image01" width="615" height="466" /></p>
<p>Demonstrating another key component of <a title="our 2015 strategy" href="http://pivotal.io/new-approach-to-big-data" target="_blank">our 2015 strategy</a>, the entire technical portion of the Pivotal Data Roadshow really highlights our robust cloud capabilities. All our attendee sessions are hosted in an enterprise public cloud infrastructure, spun up quickly and seamlessly in minutes.  This enables us to rapidly provision 50 IoT analytics labs across our entire product set. Attendees quickly initiate analytics workflows that ingest Twitter streams and execute real time analytics across our in memory database, Gemfire. Most impressively, this all gets developed in under 5 minutes, using only two Spring XD commands, replacing what used to be hours of complex and specialized programming.  Spring XD really has emerged as the star of the show, thanks to the streamlined, easy-to-understand interface it provides for our products, third party technologies, and its ability to manage either private, public, big, or fast data jobs.</p>
<p>Attendees have stayed hours past the scheduled end time, enjoying building out new analytics pipelines with our expert engineering teams. They also left with their lab environments equipped to continue their experiences on their own cloud, learning into the future.</p>
<p>If you’re interested in how big data and advanced analytics are changing companies, and would like to get your hands directly on the world’s best technology for leveraging them, be sure to check out one of the upcoming Pivotal Data Roadshows.</p>
<p><img class="alignnone size-full wp-image-11898" src="http://blog.pivotal.io/wp-content/uploads/2015/04/image001.png" alt="image00" width="787" height="273" /></p>
<p><b>Upcoming Dates for the Pivotal Data Roadshow</b></p>
<ul>
<li>Toronto, April 14</li>
<li>New York City, April 16</li>
<li>Washington, DC, April 21</li>
<li>Atlanta, April 23</li>
<li>Denver, April 28</li>
<li>Dallas/Fort Worth, April 30</li>
</ul>
<p><b>Further information:</b></p>
<ul>
<li><a title="Register for the Pivotal Data Roadshow" href="https://pivotal.io/big-data/data-roadshow" target="_blank">Register for the Pivotal Data Roadshow</a></li>
<li><a title="Learn more about the Pivotal Big Data Suite" href="http://pivotal.io/big-data/pivotal-big-data-suite" target="_blank">Learn more about the Pivotal Big Data Suite</a></li>
<li>Learn more about <a title="Spring XD" href="http://blog.pivotal.io/pivotal/products/spring-xd-for-real-time-analytics" target="_blank">Spring XD</a> and <a title="Redis" href="http://blog.pivotal.io/pivotal/case-studies-2/using-redis-at-pinterest-for-billions-of-relationships" target="_blank">Redis</a></li>
</ul>
<p><i>Editor’s Note: Apache, Apache Hadoop, Hadoop, and the yellow elephant logo are either registered trademarks or trademarks of the Apache Software Foundation in the United States and/or other countries.</i></p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://blog.pivotal.io/big-data-pivotal/products/pivotal-data-roadshow-a-view-from-the-road"> on April 06, 2015 03:09 PM</a></span>
		</div>
	</div><!-- .post -->

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://blog.pivotal.io/pivotal/case-studies-2/mobile-video-big-data-architecture-with-spring-xdhadoophawqredis-measuring-live-usage" title="Pivotal P.O.V. » Redis">Mobile Video Big Data Architecture with Spring XD/Hadoop/HAWQ/Redis: Measuring Live Usage</a></h2>

<h3>Pivotal</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><a href="http://blog.pivotal.io/wp-content/uploads/2014/10/featured-football-spectators-phone.jpg"><img class="alignleft size-full wp-image-10870" src="http://blog.pivotal.io/wp-content/uploads/2014/10/featured-football-spectators-phone.jpg" alt="featured-football-spectators-phone" width="200" height="200" /></a>Earlier this year, <a title="mobile video usage overtook video usage on personal computers" href="http://www.emarketer.com/Article/Tablets-Challenge-PCs-Leading-Digital-Video-Channel-US/1010807" target="_blank">mobile video usage overtook video usage on personal computers</a> and research continues to show how important mobile video is to consumers. With these trends, mobile carriers and media companies are trying to learn more about usage to improve user experience and advertising revenues, especially with big advertising money makers like sports.</p>
<p>Earlier this year, a major sports network and mobile carrier approached Pivotal to create a system for measuring cellular data and live video usage through mobile applications. The approach used <a title="Spring XD" href="http://projects.spring.io/spring-xd/" target="_blank">Spring XD</a>, <a title="Pivotal HD" href="http://www.pivotal.io/big-data/pivotal-hd" target="_blank">Pivotal HD</a>, <a title="Redis" href="http://www.pivotal.io/big-data/redis" target="_blank">Redis</a>, and <a title="Spring Boot" href="http://projects.spring.io/spring-boot/" target="_blank">Spring Boot</a> to quickly build a big data platform and set of analytical dashboards. The resulting analytics application is helping business executives from both companies understand how live video is used and what peak data usage looks like. The whole project only took a few resources and a few months.</p>
<h2><strong>Mobile/Media Big Data Architecture Overview</strong></h2>
<p>At a high level, data moves through a factory as depicted in the diagram below. Raw data is captured from mobile phones in JSON format by a Spring XD cluster where several processes are performed. The data is then stored in an HDFS cluster where Spring XD batch jobs use SQL via the HAWQ interface to HDFS and store the calculated reports in Redis. Spring Boot is then used with Angular.js and D3.js to show analytics to end users.</p>
<p><a href="http://blog.pivotal.io/wp-content/uploads/2014/10/ProLeague+Mobile-SolutionsArchitecture.png"><img class="alignnone size-full wp-image-10871" src="http://blog.pivotal.io/wp-content/uploads/2014/10/ProLeague+Mobile-SolutionsArchitecture.png" alt="ProLeague+Mobile-SolutionsArchitecture" width="615" height="239" /></a></p>
<h2><strong>Capturing Raw Data from Mobile Devices in JSON</strong></h2>
<p>To produce the raw data, a mobile device is instrumented to capture the number of bytes used while viewing a video. The mobile application sends a “heartbeat” message that is formatted in JSON and contains the number of bytes consumed since the last report. Generally, the mobile app sends one of these reports every minute. Since there can be a large number of viewers during a live game, the system receives millions of heartbeat messages per hour. When designing the system, we decided to keep all of the heartbeat data over time, as with the concept of keeping all data inside a <a title="data lake" href="http://blog.pivotal.io/pivotal/news-2/from-data-silos-to-data-lakes-realizing-the-accessible-dream" target="_blank">data lake</a>. This way, teams could use the data to produce additional analysis in the future. In addition, the customers had a quick timeline. They needed the system in place prior to the start of the next sports season.</p>
<h2><strong>Ingesting and Processing Data with Spring XD and HDFS</strong></h2>
<p>To handle the data ingestion, the Pivotal team utilized <a title="Spring XD" href="http://projects.spring.io/spring-xd/" target="_blank">Spring XD</a> to receive and transform the raw data. The processed data was stored in an <a title="Apache Hadoop" href="http://hadoop.apache.org" target="_blank">Apache Hadoop®</a> File System (HDFS) cluster as part of <a title="Pivotal HD" href="http://www.pivotal.io/big-data/pivotal-hd" target="_blank">Pivotal HD</a>. Spring XD and HDFS provided a flexible, scalable solution to handle the massive amount of incoming JSON heartbeat data—as much as a half terabyte per season of sports.</p>
<p>After the data was stored in HDFS, we used Pivotal HAWQ and SQL to generate the necessary reports from the data stored in HDFS. Spring XD’s batch job capability was leveraged to execute the reports after a game was done. The batch jobs produced JSON reports and stored them in <a title="Redis" href="http://blog.pivotal.io/tag/redis" target="_blank">Redis</a>, providing immediate access to a web-based dashboard. Spring XD and Pivotal HD provided clustering and failover support to ensure business continuity in the event of a server failure.</p>
<p>Spring XD turned out to be a perfect solution because it was designed with a distributed and extensible pipeline for ingesting data, processing it, performing real-time analytics on the received data, and then exporting it. Using Spring XD, we quickly implemented a system to receive the raw heartbeat data from the mobile applications. Spring XD provides several “sources” and “sinks” out of the box, and we were able to modify the existing HTTP source and HDFS sink to receive and store the raw heartbeat data. We also created a custom “processor” module that enabled us to filter and validate the raw data, ensuring that it was formatted as expected and had valid data in the expected JSON fields. Spring XD also provided a mechanism to “tap” data from one stream to another. Using a tap, it was simple for us to configure a stream to count the number of heartbeat packets received. This allowed us to ensure the system worked as expected—we could see the amount of live data going through the system in real-time. Since Spring XD supports a distributed runtime deployment, it also ensured that inbound data would continue to process in the event of any server failure.</p>
<h2><strong>Creating Analytical Reports with Spring XD, HAWQ, Redis, and Spring Boot</strong></h2>
<p>With HDFS storing the raw data, we used the <a title="Pivotal Xtension Framework" href="http://blog.pivotal.io/pivotal/products/json-on-hadoop-example-for-extending-hawq-data-formats-using-pivotal-extension-framework-pxf" target="_blank">Pivotal Xtension Framework</a> (PXF) and <a title="HAWQ" href="http://blog.pivotal.io/tag/hawq" target="_blank">HAWQ</a> to perform SQL queries directly against the JSON data. PXF maps the JSON to columns in a database, enabling HAWQ to execute SQL queries directly against the JSON data in HDFS. Using SQL, the product manager could then define the report queries.</p>
<p>For the next step, we turned to Spring XD’s batch capabilities. Custom “jobs” were configured with the appropriate SQL queries to execute. The jobs are scheduled to execute early in the morning, after a game has occurred, and the report results are stored in Redis. Redis stores all the reports so that users can view any of them without needing to spend the time computing them on demand. Finally, we implemented a simple REST API, using <a title="Spring Boot" href="http://blog.pivotal.io/tag/spring-boot" target="_blank">Spring Boot</a>, to serve the JSON reports to the user interface.</p>
<p>A web-based dashboard was also built and allows users to easily view the weekly reports as they are available. Here, Spring Boot was used with JavaScript libraries like <a title="Angular.js" href="https://angularjs.org/" target="_blank">Angular.js</a> and <a title="D3.js" href="http://d3js.org/" target="_blank">D3.js</a>. Spring Boot and Spring Security were used to quickly secure the dashboard by adding a login page and requiring HTTPS for access.</p>
<p>Together, Spring XD, Pivotal HD and HAWQ, Redis, and Spring Boot were used to quickly create a big data solution for massive ingesting, analyzing, and reporting on cellular data use for live, game-day videos. Now, the client can identify trends and optimize media revenue.</p>
<p><strong>Learn More:</strong></p>
<ul>
<li>Spring XD: <a title="Project and Documentation" href="http://projects.spring.io/spring-xd/" target="_blank">Project and Documentation</a> | <a title="Blog Articles" href="http://blog.pivotal.io/tag/spring-xd" target="_blank">Blog Articles</a> | <a title="Using XD for Real Time Twitter" href="http://blog.pivotal.io/pivotal/products/spring-xd-for-real-time-analytics" target="_blank">Using XD for Real Time Twitter</a></li>
<li>Pivotal HD (SQL on HDFS via HAWQ): <a title="Product" href="http://www.pivotal.io/big-data/pivotal-hd" target="_blank">Product</a> | <a title="Documentation" href="http://pivotalhd.docs.pivotal.io/doc/2010/index.html" target="_blank">Documentation</a> | <a title="Blog Articles" href="http://blog.pivotal.io/tag/pivotal-hd" target="_blank">Blog Articles</a></li>
<li>Redis: <a title="Website" href="http://blog.pivotal.io/tag/redis/redis.io" target="_blank">Website</a> | <a title="Blog Articles" href="http://blog.pivotal.io/tag/redis" target="_blank">Blog Articles</a></li>
<li>Spring Boot: <a title="Project and Documentation" href="http://projects.spring.io/spring-boot/" target="_blank">Project and Documentation</a> | <a title="Blog Articles" href="http://blog.pivotal.io/tag/spring-boot" target="_blank">Blog Articles</a></li>
<li>Pivotal Open Source: <a title="Products and Projects" href="http://www.pivotal.io/oss" target="_blank">Products and Projects</a> | <a title="Blog Articles" href="http://blog.pivotal.io/tag/open-source" target="_blank">Blog Articles</a></li>
</ul>
<p><em><strong>Editor&#8217;s Note</strong>: Apache, Apache Hadoop, Hadoop, and the yellow elephant logo are either registered trademarks or trademarks of the Apache Software Foundation in the United States and/or other countries.</em></p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://blog.pivotal.io/pivotal/case-studies-2/mobile-video-big-data-architecture-with-spring-xdhadoophawqredis-measuring-live-usage"> on October 13, 2014 09:43 AM</a></span>
		</div>
	</div><!-- .post -->

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://blog.pivotal.io/pivotal/news-2/apache-way-at-pivotal" title="Pivotal P.O.V. » Redis">Apache Way at Pivotal</a></h2>

<h3>Pivotal</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><img class="alignleft size-full wp-image-10839" src="http://blog.pivotal.io/wp-content/uploads/2014/10/featured-feathers.png" alt="featured-feathers" width="200" height="200" />Ever since I joined Pivotal, one of my favorite topics of cocktail conversation has become explaining to folks unfamiliar with the company just how much of a <a title="Open Source is Pivotal" href="http://blog.pivotal.io/pivotal/products/open-source-is-pivotal" target="_blank">quintessential open source shop we are</a>. Just rattling off the names of the projects and communities we stand behind feels like listing &#8216;who&#8217;s who&#8217; of open source. Being a betting man as I am, I typically introduce Pivotal by making a $1 bet that whoever I&#8217;m talking to is likely to have used software we contribute to at some point in their career. Given that this list includes <a title="Cloud Foundry" href="http://www.pivotal.io/platform-as-a-service/pivotal-cf" target="_blank">Cloud Foundry</a>, <a title="Spring Framework" href="http://projects.spring.io/spring-framework/" target="_blank">Spring Framework</a>, <a title="Groovy" href="http://groovy.codehaus.org/" target="_blank">Groovy</a>, <a title="Grails" href="https://grails.org/" target="_blank">Grails</a>, <a title="Redis" href="http://www.pivotal.io/big-data/redis" target="_blank">Redis</a>, <a title="RabbitMQ" href="http://www.pivotal.io/products/pivotal-rabbitmq" target="_blank">RabbitMQ</a>, <a title="Tomcat" href="http://tomcat.apache.org/" target="_blank">Tomcat</a> and most recently <a title="Apache Hadoop" href="http://hadoop.apache.org" target="_blank">Apache Hadoop®</a> the only folks I ever lose to are the poor souls still stuck on Windows 95 or mainframes. Paying $1 to them feels less like losing a bet, and more like a random act of kindness.</p>
<p>As a side note, this incredible diversity of Pivotal&#8217;s open source portfolio helps our business model a great deal. After all, the days when one could have a sizable stand-alone business built around a single open source project are as distant as dial-up internet access. There&#8217;s a lot to be said on what a winning open-source strategy looks like (I may dare defining one in one of my future blog posts). Whatever it is, if you are an enterprise infrastructure vendor in 2014, you can&#8217;t survive without having one. The market has clearly spoken in favor of enterprise infrastructure products built around open source projects. With this came a realization that the only sustainable way of doing so was to build long-term relationships with open source communities. This, of course, meant that business now found themselves thinking deep and hard about open source community governance.</p>
<p>It is perhaps ironic, that the single most important detail of how open source communities operate doesn&#8217;t get as much air time as licensing or patenting. Somehow there&#8217;s a perception that open source communities don&#8217;t even need much of governance. They are expected to self-organize into utopian worker collectives that could serve as a living illustration to &#8220;from each according to his ability, to each according to his need&#8221; principle. Nothing can be further from the truth. Each big, successful open source community is unique and typically very particular about the governance model. Open source communities, and by extension projects that they work on, live and die by how effective their governance model is. A great community can alway fix technology, a poor community is bound to ruin the best technology that is entrusted to it.</p>
<p>Now, remember my earlier point about the sheer size of Pivotal&#8217;s open source portfolio? Community governance is where it starts to matter yet again. Because you see, regardless of how much a runaway success Spring is (and standing at 8+ million users nobody would argue it isn&#8217;t) the governance model that made it so successful is unique to it. It is true that Spring uses Apache License, but the similarities with the Apache Software Foundation (ASF) governance model ends there.</p>
<p>ASF governance model, also known as &#8220;The Apache Way&#8221;, is a very unique, extremely well thought out approach to building successful open source communities. Communities that are capable of innovating on a diverse set of projects all living under the Foundation&#8217;s umbrella. &#8220;The Apache Way&#8221; has been covered in great details over the years, its elevator pitch fits in just three words: &#8220;Community over code&#8221;. No really, that is it—everything else is an implementation detail.</p>
<p>It must be said, that even before I joined Pivotal, the company has had a relationship with the ASF. We have been a constant sponsor of the Foundation and with guys like Mark Thomas and Bill Rowe working for Spring side of Pivotal &#8220;The Apache Way&#8221; was practiced quite well when it comes to Apache Tomcat and Apache HTTPD. At the same time, the scale at which Datafabrics side of Pivotal has embraced ASF projects around Apache Hadoop® ecosystem required a different level of focus on ASF.</p>
<p><a href="http://www.pivotal.io/careers"><img class="alignnone size-full wp-image-9320" src="http://blog.pivotal.io/wp-content/uploads/2014/06/cta-hiring.png" alt="cta-hiring" width="600" height="135" /></a></p>
<p>So that was part of my mission when joining Pivotal: become a resident ASF guy for data technologies organization and <em>make sure that in a year&#8217;s time Pivotal becomes a company that grows the pool of Apache Committers, not a company that just fights over the existing pool.</em></p>
<p>This project started with putting a framework in place that enables Pivotal engineers to collaborate on ASF software with minimum distraction (this required a close collaboration with our outstanding legal team). Our next step was to review our product roadmap and based on customer&#8217;s feedback start focusing on a project that they needed. This is what our <a title="Strengthening Apache Hadoop in the Enterprise with Apache Ambari" href="http://blog.pivotal.io/pivotal/features/strengthening-hadoop-in-the-enterprise-with-apache-ambari" target="_blank">previous announcement around Apache® Ambari</a> was all about.</p>
<p>In the short couple of month we have not only contributed a <a title="AMBARI-7292" href="https://issues.apache.org/jira/browse/AMBARI-7292" target="_blank">wide</a> <a title="AMBARI-7551" href="https://issues.apache.org/jira/browse/AMBARI-7551" target="_blank">variety</a> of improvements to it, but also helped the project get more stable by working on<a title="Ambari-trunk-Commit" href="https://builds.apache.org/view/All/job/Ambari-trunk-Commit/" target="_blank"> build </a>and <a title="AMBARI-7209" href="https://issues.apache.org/jira/browse/AMBARI-7209" target="_blank">CI automation</a> and suggesting <a title="Proposal" href="http://markmail.org/message/rs5j5j365txapalm" target="_blank">process improvements</a> to innovate even quicker while not losing the sense of project stability. Pivotal&#8217;s product has benefited from this relationship, but so did Apache® Ambari: it has become better and more featureful, but most importantly its community has grown stronger and more diverse. In fact, recognizing all the hard work that one of Pivotal&#8217;s engineers Jun Aoki has put into the project, the Apache® Ambari PMC has <a title="Jun invited to Ambari" href="http://markmail.org/message/dwfwtercyj3s6moq" target="_blank">voted</a> Jun in as a committer.</p>
<p>This may be a small step for Jun (and, to be sure, the first one in many other ASF projects that he is going to join), but it actually signifies a giant leap for Pivotal and the kind of role it is assuming in ASF from now on. We&#8217;re already delivering on that fundamental vision of making sure that our engineers get fully empowered to lead most impactful open source projects within the Foundation. If you are an engineer dreaming to add the coveted Committer/PMC of Apache X to your resume, join us. We can&#8217;t guarantee that you will get that line (after all, ASF recognizes your personal merit and your personal merit alone) but we can guarantee that we will move heaven and earth to empower you to do so.</p>
<p>After all a stronger Apache Software Foundation (ASF) will benefit the entire industry. It is, you see, that proverbial tide that lifts all boats big and small.</p>
<p><em><strong>Editor&#8217;s Note</strong>: Apache, Apache Hadoop, Hadoop, and the yellow elephant logo are either registered trademarks or trademarks of the Apache Software Foundation in the United States and/or other countries.</em></p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://blog.pivotal.io/pivotal/news-2/apache-way-at-pivotal"> on October 08, 2014 04:27 PM</a></span>
		</div>
	</div><!-- .post -->

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://blog.pivotal.io/pivotal-cloud-foundry/case-studies-2/case-study-how-shrebo-the-sharing-economy-platform-innovates-with-cloud-foundry" title="Pivotal P.O.V. » Redis">Case Study: How shrebo, the Sharing Economy Platform, Innovates with Cloud Foundry</a></h2>

<h3>Pivotal</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><a href="http://blog.pivotal.io/wp-content/uploads/2014/09/featured-time-to-innovate.png"><img class="alignleft size-full wp-image-10437" src="http://blog.pivotal.io/wp-content/uploads/2014/09/featured-time-to-innovate.png" alt="featured-time-to-innovate" width="200" height="200" /></a>In this post, former banking technology architect and current CTO, Patrick Senti, allows us to pick his brain and learn about his experiences with Cloud Foundry and Python/Django.</p>
<p>As background, Senti is an award-winning architect and programmer who is also certified in machine learning. He brings over 20 years of software experience from working on high profile projects at companies like IBM, SAS, and Credit Suisse.</p>
<p>Recently Senti founded <a title="shrebo" href="https://www.shrebo.com/lang/?lang=en&next=/business/" target="_blank">shrebo</a> and is currently CTO. Much like Uber, AirBnB, and Zipcar, his company uses cloud platforms to create new ways of sharing resources.  shrebo recently won an innovation award from Swiss Federal Railways (who is also a customer) and provides an entire web-services-based SaaS platform—<a title="a set of APIs" href="https://www.shrebo.com/lang/?lang=en&next=/developer/" target="_blank">a set of APIs</a> for application developers to build with. Shrebo is the cloud platform for the sharing economy—allowing you to build your own AirBnB or Lyft on shrebo.</p>
<p>The functionality includes search, booking, scheduling, provisioning, payment, and social functionality endpoints surrounding the entire process of sharing resources. With their services, third parties can cost effectively and quickly create sharing applications in mobile, social, local and other contexts to help automate logistics, optimize machinery, increase asset and fleet utilization, and run services for sharing any type of resource like cars, bikes, or parking spaces.</p>
<p><strong>In three short sentences, what defined your needs for a platform like Cloud Foundry?</strong></p>
<ol>
<li>Architecting a start-up with a big vision means we needed stability at the ground level.</li>
<li>We need developers to focus on solving problems and coding instead of technical details.</li>
<li>While stacks like Amazon were interesting, we needed to be higher up the stack to make service distribution easier.</li>
</ol>
<p><strong>If you could summarize, what would you say the outcomes have been so far?</strong><br />
This PaaS platform reduces risk and creates a lot of efficiency and effectiveness. <a title="Cloud Foundry" href="http://www.pivotal.io/platform-as-a-service/pivotal-cf" target="_blank">Cloud Foundry</a> is a real blast of an experience as a developer. We essentially package the application along with the services manifest and press a button. Everything else is done by the platform. This type of thing used to take days or weeks. Now, it takes minutes.</p>
<p><strong>OK, let’s cover some background. How did you, as an entrepreneur, decide to start this company?</strong><br />
Well, it was really three ideas that came together.</p>
<p>A few years back, I shared a sailboat with other people. It was always difficult to manage the logistics because smartphones were not as common. However, the idea of making the process easier…that stuck with me. I thought, “It would be really useful to have a sharing service for any private resource.”</p>
<p>Two, it’s easy to see how more and more resources are shared between people across companies. If you work at the same company, everyone is on a shared calendar; so, it’s not needed. When people come together across companies, like in a start-up environment or if you share some large asset like trains, you need a better way to share. It seemed like a good idea to have an API-based platform to help build solutions like this.</p>
<p>Lastly, I have done a lot with analytics. I realized there could be process improvement and optimization if people and companies could successfully share information and results. For example, we cooperate with Swiss Federal Railways, who awarded us a winner for innovation as a start-up, and they operate tons of trains and cars each day. The trains are very overused in many city areas. When they are full, commuters don’t know where to sit. In fact, this is a sharable resource. So, my “aha” moment here was about connecting people via a smartphone app—we could allow them to see and chose travel based on load and occupancy. They could make a conscious decision to board a certain train. We could really help improve this if we use predictive analytics. So, we do that too—this is much like managing meeting rooms but on a really large scale.</p>
<p><strong>Could you tell us more about shrebo as a business and how Pivotal and Cloud Foundry fit?</strong><br />
In a nutshell, companies use our stuff to build their own end-user sharing applications.</p>
<p>We are a platform software services for any sharing solution. If you are familiar with car sharing, like a renting process or a smartphone app for scheduling a car like <a title="Zipcar" href="http://www.zipcar.com/" target="_blank">Zipcar</a> or <a title="Uber" href="https://www.uber.com/" target="_blank">Uber</a> in the U.S., our platform supports all the functionality you would need to build such an app through a set of developer APIs. The shrebo platform allows companies of any size to more easily and cost effectively <a title="develop their own sharing applications" href="https://www.shrebo.com/lang/?lang=en&next=/developer/" target="_blank">develop their own sharing applications</a> and online services and mix them with other mobile, social, and local apps.</p>
<p>In our initial architecture process, we evaluated several PaaS providers. Ultimately, we chose <a title="App Fog" href="https://www.appfog.com/" target="_blank">App Fog</a>, who is now <a title="owned by CenturyLink" href="http://blog.pivotal.io/cloud-foundry-pivotal/news-2/pivotal-moves-to-establish-open-governance-model-for-cloud-foundry" target="_blank">owned by CenturyLink</a>. They run <a title="Cloud Foundry" href="http://cloudfoundry.org/" target="_blank">Cloud Foundry</a> with Python, Java, Node.js, PHP, and Ruby. Our technology framework allows us to elastically provision services through App Fog’s services API. Also, Pivotal provides us with Redis as a data structure service and RabbitMQ as a message broker service.</p>
<p><strong>How will your customer experience be improved through our technologies?</strong><br />
Well, our app is not directly visible through some user interface for end users, it is more of a white label solution. However, we provide app and data services that enable others to provide end-user applications. So, those companies can rely on our API to meet SLAs cost effectively. Eventually, they need their apps to perform or users will go somewhere else. If we fail, so do they.</p>
<p>In the context of us powering other technologies, we use Cloud Foundry and AppFog to provision services much faster, at a lower cost, and with greater scale as real-time demand shifts. This PaaS is certainly more cost effective than Amazon, and it’s less complex and risky than traditional hosting providers who make us build the stack by ourselves. It’s also very automated. All of these things allow us to deliver code, deploy updates, and fix issues on our platform quickly.</p>
<p><strong>Do you have any examples where Cloud Foundry’s Elastic Runtime Service delivered something unexpected?</strong><br />
Yes, absolutely. At one point in time, the AppFog infrastructure needed an upgrade. They had some planned downtime and planned to make changes to one data center at a time across Singapore, Ireland, and the U.S. With Cloud Foundry, we had zero down time even though they did. As they were bringing down a data center to make updates, we set up new instances on the fly and shifted workloads. As they moved around the world, we automatically migrated across data centers. We didn’t have any downtime even though they did! Before Cloud Foundry, this was really not possible. We could increase and decrease instances on the fly. Quite amazing.</p>
<p><strong>How does Cloud Foundry compare to other platforms you have worked with?</strong></p>
<p>Provisioning is so different. So, I spent a lot of time in the financial services industry—for about 10 years. We primarily worked with traditional hosting platforms. You get a Linux machine, then you do an install. Along the process, a group of experts all touch it before it is ready to deploy code. Cloud Foundry it totally different.</p>
<p>Like I said before, Cloud Foundry is a real blast of an experience as a developer. This type of thing used to take days or weeks. Now, it takes minutes. As a CTO, this is the experience every developer has been looking for over the past 10 years. We get the power of scripting—an event can trigger just about anything we need.</p>
<p><strong>What other overarching Cloud Foundry capabilities are top of mind?</strong><br />
Flexibility and agility are top of the list. I see extensibility as a major benefit too. The whole architecture is built with open source contributions in mind. Adding new stacks is encouraged.</p>
<p><strong>How does Cloud Foundry and AppFog support your stack?</strong><br />
Cloud Foundry is the PaaS and AppFog integrates and operates the PaaS and IaaS. They also provide a Django/Python stack on Cloud Foundry. We didn’t have to do anything to get this set up. It was provided when we turned on our account. This is the way development should work!</p>
<p><strong>Could you tell us a bit about the other services you use on Cloud Foundry?</strong></p>
<p>We use <a title="Redis" href="http://docs.pivotal.io/p1-services/Redis.html" target="_blank">Redis</a> and <a title="RabbitMQ" href="http://docs.pivotal.io/rabbitmq-cf/index.html" target="_blank">RabbitMQ</a>—these are both very powerful services for data structure and messaging middleware, and we have two main use cases. We use MySQL for persistence, also provisioned and managed by Cloud Foundry.</p>
<p>First, we provide elements of a web app and APIs as a service to the outside world. The runtime is a traditional Python process intended for short-lived, synchronous workloads. Second, there are many asynchronous processes that trigger over time. For example, the website generates a lot of events. If someone is booking a resource, confirming a booking, or cancels, these are all events. Workflow workloads run asynchronously in the background and do various things like send an SMS or email. There is a separation of concerns here between the two types of workloads, short-lived web requests, and longer-lived  background tasks, and we use RabbitMQ to decouple these sub-systems, and it is used on both sides.</p>
<p>Our RabbitMQ uses Redis as an in-memory data store to transport the messages between the two areas—the web APIs and the messaging, which is based on <a title="Celery" href="http://celery.readthedocs.org/en/latest/getting-started/brokers/rabbitmq.html" target="_blank">Celery</a> as well. In addition, we use Redis as a distributed log instance—as soon as a reservation is made, we want to ensure no one else can grab the resource. Since we have four or five instances on the web API side, we run into a distributed lock problem. Redis solves this problem for us. So, RabbitMQ is the broker, Redis powers the state of notification events, and it also acts as a data store to log transaction events—for all events and messages across the two workloads.</p>
<p>The workflows, events, and messages store data in an analytics warehouse. At this point, we are using <a title="Apache Hadoop" href="http://hadoop.apache.org" target="_blank">Apache Hadoop®</a>, but we haven’t deployed it at a large scale quite yet. We are also looking at Storm.</p>
<p><a href="http://www.pivotal.io/sites/default/files/documents/shrebo_Case%20Study_082914_0.pdf"><img class="alignnone size-full wp-image-10832" src="http://blog.pivotal.io/wp-content/uploads/2014/10/cta-casestudy-shrebo.png" alt="cta-casestudy-shrebo" width="600" height="135" /></a></p>
<p><strong>While you are a CTO, you were a developer at one point and probably get your hands dirty at times. What makes Cloud Foundry so cool for developers?</strong><br />
Cloud Foundry has a command line interface, and AppFog has built an API. As I mentioned earlier, this gives developers the power of scripting. We spend more time coding and less time dealing with the foundational platform. So, all deployment tasks—infrastructure, new instances, deploying code, unit testing, integration testing, screen tests—all of this can be scripted. We push a button to trigger these processes. While this is possible with any modern infrastructure, Cloud Foundry really gives us the ability to stay at a high level in the stack and avoid getting into details.</p>
<p>We also really like the separation between applications and code. When we write the deployment manifest and need services like <a title="MySQL" href="http://docs.pivotal.io/p-mysql/index.html" target="_blank">MySQL</a> or <a title="Redis" href="http://docs.pivotal.io/p1-services/Redis.html" target="_blank">Redis</a>, we just tell the system we need an instance of it in a few lines of configuration without having to worry about the config of the underlying service. The underlying stuff is all handled by the platform.</p>
<p>We have gotten off the ground very quickly. In fact, Facebook has this concept of hiring developers to deploy code in the same day they started. Now, we have the same type of environment—one of our new developers can deploy code the same day they start with shrebo. This is one of the most exciting facts about Cloud Foundry—we can have a small team of 4 people work on the app and run the infrastructure, and we can scale people this way too. Five years ago, it would have required 10 or more people to run this same infrastructure and do development.</p>
<p><strong>In terms of monitoring, are you using any of Cloud Foundry’s built in capabilities?</strong></p>
<p>Well, we aren’t using the Cloud Foundry health check services API directly. We decided to use New Relic as the application-level performance metrics monitor. From outside, we use Pingdom to verify uptimes. New Relic as extremely easy to plug into Cloud Foundry applications—they have a Python extension that works out of the box with Cloud Foundry. As described we use RabbitMQ to do app-level event processing, but we also use it to send New Relic custom events to their services infrastructure.</p>
<p><strong>As a CTO/CIO level person with a financial services background, you have a clear handle on ROI, C-level metrics, and risk management. What about Cloud Foundry is powerful from this perspective?</strong><br />
If I talk about this from my banking background, I can easily see how Cloud Foundry produces efficiency and effectiveness—this helps reduce costs and risk. Let me explain.</p>
<p>When we release code <em>without </em>Cloud Foundry, it might take 4-6 months at a traditional bank with more complexity and legacy systems. With Cloud Foundry, you can reduce that time to days or weeks. There is an order of magnitude level of improvement in terms of these process metrics. There are fewer people involved, it is easier for developers to fix problems, we can scale dynamically without emailing anyone—this all reduces cost and time, and as a result increases the productivity of the whole organization</p>
<p>In terms of risk, Cloud Foundry clearly reduces operational risk. This is largely related to the lower number of people that need to be involved. For example, if an app shows signs of crashing, we don’t have to involve a team to resolve. A developer can fix the code, and an automated, daily build can update the problems or a button can redeploy without five people having to coordinate on a conference call or group chat. As well, I’ve described how the scale and uptime scenarios work—this reduces downtime and ensures SLA support. This is particularly important for mission-critical, revenue generating apps. So, Cloud Foundry has a direct impact on the risk of our top and bottom line.</p>
<p><strong>Would you mind sharing an architecture slide on your stack?</strong><br />
Sure, here see below. We use HTML5/Bootstrap, JSON/REST, Redis, MongoDB, RabbitMQ, MySQL, and Python/Django for the online services or real-time runtime. There is some overlap here with our batch or periodic workloads. This part of the architecture is another conversation all together. However, we use R, Elastic Search, Storm, Apache Hadoop®, and much more. The infrastructure includes Nginx, Varnish, Gunicorn, Cloud Foundry, Cloudinary, Searchly, Amazon AWS, Mailgun, and GlobalSMS.</p>
<p><strong>Thank you so much, is there anything you’d like to add from a personal perspective? What do you like to do in your off time? Anything you’d like to accomplish before you leave this little rock we call Earth?</strong><br />
Sure. In my spare time I like to spend time with friends and family. I also very much enjoy to ride the bike in the woods, or sail that very boat that we used to share, which is based on a small lake in Switzerland. In extension of this, I plan to do a lot more sailing at sea, in fact one of my dreams is to become a certified skipper for maritime sailing yachts.</p>
<p><em><strong>Editor&#8217;s Note</strong>: Apache, Apache Hadoop, Hadoop, and the yellow elephant logo are either registered trademarks or trademarks of the Apache Software Foundation in the United States and/or other countries.</em></p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://blog.pivotal.io/pivotal-cloud-foundry/case-studies-2/case-study-how-shrebo-the-sharing-economy-platform-innovates-with-cloud-foundry"> on September 03, 2014 05:30 PM</a></span>
		</div>
	</div><!-- .post -->

			</div><!-- #content -->
		</div><!-- #container -->

		<div id="secondary" class="aside main-aside">
			<ul class="xoxo">
				<li class="widgetcontainer widget_text">
					<h3 class="widgettitle">About the Community Redis Blog Aggregator</h3>
					<p>This website is a community-maintained and inclusive feed of Redis-related blog posts. To add your blog's feed, please fork <a href="https://github.com/xaprb/planetredis">the repository</a>, modify the config.ini file to add your feed at the end, and submit a pull request.</p>
				</li>
				<li class="widgetcontainer widget_extended-categories">
					<h3 class="widgettitle">Feeds</h3>
					<ul>
						<li>
							<a href="http://antirez.com/rss" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)" /></a> <a href="http://antirez.com" title="Antirez weblog">Antirez</a>
						</li>
						<li>
							<a href="http://blog.pivotal.io/tag/redis/feed" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)" /></a> <a href="http://blog.pivotal.io" title="Pivotal P.O.V. » Redis">Pivotal</a>
						</li>
						<li>
							<a href="https://redislabs.com/feed" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)" /></a> <a class="message" title="internal server error">Redis Labs</a>
						</li>
					</ul>
				</li>
			</ul>
		</div><!-- #secondary .aside -->
		<div class="clearBoth"></div>
	</div><!-- #main -->
</div><!-- #wrapper .hfeed -->

<div id="footer">
	<div id="siteinfo">
		<p>
			&copy; <a href="https://vividcortex.com/">VividCortex</a><br />
			Blog entries aggregated on this page are owned by, and represent the opinion of the author. Header image courtesy of <a href="https://www.flickr.com/photos/will_spark/8602965477">will_spark</a> on Flickr, CC-licensed. Theme/template derived from Planet Ubuntu's. Powered by <a href="http://planetplanet.org">Planet Planet</a>.<br />
		</p>
	</div><!-- #siteinfo -->
</div><!-- #footer -->
</body>
</html>
