<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<title>Community Redis Aggregator</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="robots" content="index,follow" />
	<link rel="stylesheet" type="text/css" href="css/style.css" />
	<link rel="alternate" type="application/rss+xml" href="http://www.planetredis.org/rss20.xml" title="Community Redis Aggregator RSS" />
	<script src="//assets.ubuntu.com/sites/ubuntu/latest/u/js/plugins/yui-combined.min.js"></script>
	<link rel="stylesheet" type="text/css" media="all" href="//fonts.googleapis.com/css?family=Ubuntu:300,400,400italic" />
</head>

<body class="blog">
<div id="wrapper" class="hfeed">

<div id="header">

<div id="orangeHeader">
	<h1>
		<a href="http://www.planetredis.org/" title="Community Redis Aggregator"><span>Community Redis Aggregator</span></a>
	</h1>
</div>

</div>

	<div id="main">
		<div id="container">
			<div id="content">



		<h3 id="todaysDate">June 09, 2015</h3>

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="https://redislabs.com/blog/cve-2015-4335-dsa-3279-redis-lua-sandbox-escape" title="Redis Labs">CVE-2015-4335/DSA-3279 – Redis Lua Sandbox Escape</a></h2>

<h3>Redis Labs</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><img alt="" class="aligncenter size-full wp-image-10143" height="200" src="https://redislabs.com/wp-content/uploads/2015/06/20150608_pmr_art.png" title="Pimp My Redis - The Lua Sandbox Escape" width="635" /></p>

<p><b>What happened?</b> Last week, in a post titled <a href="http://benmmurphy.github.io/blog/2015/06/04/redis-eval-lua-sandbox-escape/" target="_blank">"Redis EVAL Lua Sandbox Escape"</a>, security researcher Ben Murphy unveiled the details of a known Lua exploit that can be used for breaking out of Redis' sandbox. Mr. Murphy was also kind enough to provide a patch that addresses said issue, which in turn was immediately included in <a href="https://groups.google.com/forum/#!msg/redis-db/4Y6OqK8gEyk/Dg-5cejl-eUJ" target="_blank">new releases for Redis v2.8.21 and v3.0.2</a> from antirez, a.k.a. Salvatore Sanfilippo (as reported in last week's <a href="https://redislabs.com/redis-watch-archive/46#lua-sandbox-escape" target="_blank">Redis Watch</a> newsletter).</p>

<p><b>How serious is this?</b> Any security vulnerability is serious business, but while a malicious person can indeed exploit vulnerability to wreck havoc, it does require a non-trivial amount of skill do so. For example, refer to this sample code that's designed to attack Lua 5.1 on a Windows 32-bit platform: <a href="https://gist.github.com/corsix/6575486" target="_blank">https://gist.github.com/corsix/6575486</a>. Furthermore, the exploit itself is but one step in a process that would involve attacking additional components of the compromised system. The bottom line is that while you should definitely take steps to protect your Redis servers against this exploit, keep in mind that the risk isn't considered high.</p>

<p><b>How can you protect yourself?</b> There are several steps you can take to protect your Redis from would-be-hackers' pwnage. Here they are in order of importance:</p>

<ol>
	<li><b>Use password authentication</b> – If you're not using it, anyone can connect to it and <a href="https://twitter.com/itamarhaber/status/591017658604216321" target="_blank">pimp your Redis</a>.</li>
	<li><b>Use password authentication</b> – Seriously, use a password.</li>
	<li><b>Moar security</b> – If you're using Redis Cloud or Redis Labs Enterprise Cluster (RLEC), consider using the access control lists provided from your dashboard to restrict access by security group and/or IP addresses or subnets. If you're running your own Redis servers, a firewall with some hard-and-sane policies can get you the same effect.</li>
	<li><b>SSL authentication and encryption</b> – Protect yourself further by switching to a Redis Cloud or RLEC <a href="https://redislabs.com/kb/read-more-ssl" target="_blank">SSL-enabled database</a>. Do-it-yourselfers can <a href="https://redislabs.com/blog/using-stunnel-to-secure-redis" target="_blank">use stunnel</a> to secure their servers in the same manner.</li>
</ol>

<p><b>Upgrade your Redis</b>. The new versions of open source Redis include the fix so you should be all good once you upgrade (if you're running your own). RLEC users only need to install the newest software update in order apply the patch to their databases. We've also backported the patch to our cloud service, so new databases are immune to the vulnerability and we're applying it online to existing instances. If you have any concerns or questions please contact our help desk at: <a href="mailto:support@redislabs.com" target="_blank">support@redislabs.com</a></p>

<p><b>Quick n' dirty n' awesome tip:</b> here's a little nugget from <a href="https://news.ycombinator.com/item?id=9658937" target="_blank">geocar</a> – rename QUIT to POST to deal with that SSRF threat &lt;- lovely!</p>

<p><b>Redis Trivia:</b> AFAIK, this is the first Redis vulnerability that was registered in the MITRE Common Vulnerabilities and Exposures Directory (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4335" target="_blank">CVE-2015-4335</a> which is no longer up for some reason, did it escape too?) and at the Debian Security Advisory (<a href="https://www.debian.org/security/2015/dsa-3279" target="_blank">DSA-3279</a>) so double yay! Also note how, by sheer conspicuous coincidence, the DSA's ID for the vulnerability is given by the following formulae:</p>

<p><img src="https://redislabs.com/wp-content/uploads/2015/06/lua_sandbox_dsa.png" /></p>

<p>I'm still working on cracking the logic behind the CVE ID thoughâ€¦ Any Suggestions? Questions? Feedback? <a href="mailto:itamar@redislabs.com" target="_blank">Email</a> or <a href="https://twitter.com/itamarhaber" target="_blank">tweet</a> at me – I'm highly available :)</p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="https://redislabs.com/blog/cve-2015-4335-dsa-3279-redis-lua-sandbox-escape"> on June 09, 2015 10:52 AM</a></span>
		</div>
	</div><!-- .post -->

		<h3 id="todaysDate">June 08, 2015</h3>

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="https://redislabs.com/blog/introduction-to-redis-labs-enterprise-cluster" title="Redis Labs">Introduction to Redis Labs Enterprise Cluster (RLEC)</a></h2>

<h3>Redis Labs</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><img alt="Redis Lab Enterprise Cluster (RLEC): Introduction" class="aligncenter size-full wp-image-10121" height="200" src="https://redislabs.com/wp-content/uploads/2015/06/2015-06-07.png" title="Redis Lab Enterprise Cluster (RLEC): Introduction" width="635" /></p>

<h3 dir="ltr">Who is RLEC good for?</h3>

<p dir="ltr">Redis is a great technology, it is VERY fast, it is very simple to use and at the same time very sophisticated and powerful. For these reasons Redis has seen tremendous adoption and has become a mainstay of modern day application stacks.</p>

<p dir="ltr">When you need to use Redis in more complex scenarios and treat it as a full blown database (with high-availability and scalability in order to be able to grow to big datasets) or as a highly available and scalable cache, you can use enhancements like Redis Sentinel and Redis Cluster. Once again great technologies, but not trivial to get initially deployed or manage afterwards.</p>

<p dir="ltr">Some customers would like to use Redis as a full blown product vs. a set of great technologies. What differentiates a technology from a product in my view is the ability to seamlessly use Redis for any need, from the most simple usage scenario, like a volatile cache on a single server, to the most complex scenario, like a huge highly-available sharded database that can span multiple servers and survive server crashes.</p>

<p dir="ltr">Another aspect that differentiates using a technology vs. a product in my mind is getting a full-blown management UI to manage and monitor the Redis databases, as well as end-to-end support for your Redis deployment and how to use it.</p>

<p dir="ltr">Lastly, in spite of the growing demand by companies to use open-source technologies, many companies would like the technology to be commercially supported and backed by a company that is committed to the future of the product and can provide support for any need. If you ever consult the big analyst firms, they always recommend against using the open-source technology as-is without getting commercial support for it.</p>

<p dir="ltr">For the above reasons we have created Redis Labs Enterprise Cluster (RLEC): to completely relieve you of the burden related to deploying, provisioning, configuring, managing and monitoring Redis. RLEC makes it really simple to ensure high-availability across racks or data-centers, create and manage a clustered Redis database and provide automatic cluster rebalancing. With RLEC, you also gain commercial support for your Redis usage, provided by Redis Labs.</p>

<h3 dir="ltr">What does RLEC give you beyond open-source Redis?</h3>

<p dir="ltr">RLEC is practically a multi-tenant system that acts as a container for running multiple databases on the same cluster infrastructure. Each database can be from the following configuration:</p>

<ul>
	<li dir="ltr">Simple Redis database (i.e. a single master shard)</li>
	<li dir="ltr">Highly-available Redis database (i.e. master / slave shards or master / multi-slave shards)</li>
	<li dir="ltr">Redis clustered database (i.e. multiple master shards)</li>
	<li dir="ltr">Highly-available Redis clustered database (i.e. multiple master shards each with its own slave shard, or multiple master / multi-slave shards)</li>
</ul>

<p dir="ltr">As a result, after installing RLEC (which is a simple task by itself that I will cover in an upcoming blog post) you can easily provision and manage multiple Redis databases, spanning multiple servers, while maintaining high-availability, and be able to scale up or down the databases as your needs change. You can do all of this through RLEC’s management UI, through the <code>rladmin</code> Command Line Interface (CLI), or through a REST API. In addition you can view various statistics to understand what is going on in each of your databases, each of the cluster nodes, or in the cluster as a whole. Apart from viewing these, you can sign up to receive alerts in the UI itself, and via email, as well as be notified by the cluster, on different events or thresholds, so you can be aware and take actions.</p>

<p dir="ltr">There are many more advanced capabilities and logic that we have implemented as part of RLEC that are too long or sophisticated to cover in this post, but you can read more about these in the <a href="https://redislabs.com/redis-enterprise-documentation/overview" target="_blank">RLEC documentation</a>.</p>

<h3 dir="ltr">Why should you trust RLEC?</h3>

<p dir="ltr">It is important to note that although RLEC is inherently running the open source Redis, we, at Redis Labs, have implemented a lot of intellectual property within RLEC to better manage Redis as a highly-available and scalable database.</p>

<p dir="ltr">This intellectual property has been built for several years while running the same technology as a cloud service named <a href="https://redislabs.com/redis-cloud" target="_blank"> Redis Cloud</a> that is available on all major cloud platforms (AWS, Azure, GCE, SoftLayer, etc.) and has helped thousands of our customers survive multiple server failures, as well as entire datacenter failures.</p>

<p dir="ltr">What we’ve done now in RLEC is taken this technology we’ve built during the years and repackaged it as downloadable and installable software that you can install anywhere you’d like, whether on your own cloud instances, or your servers running within your private data-center. We’ve gotten demand for this ability from customers who were not able to use our cloud service for various reasons, such as customers who cannot run on a public cloud platform, customers who want to run within their virtual private cloud and cannot connect from it to an external service, or customers who need to comply to different information security standards.</p>

<h3>So how do you get started with RLEC?</h3>

<p>Like I indicated above, getting started with RLEC is very simple, and I will cover more detailed information on that in a future post, but you can probably figure it out yourself using our documentation and get started by:</p>

<ol>
	<li>Download RLEC from <a href="https://redislabs.com/redis-enterprise-downloads" target="_blank">https://redislabs.com/redis-enterprise-downloads</a></li>
	<li>Follow the instructions at <a href="https://redislabs.com/redis-enterprise-documentation/installing-and-upgrading/accessing-and-installing-the-setup-package" target="_blank">https://redislabs.com/redis-enterprise-documentation/installing-and-upgrading/accessing-and-installing-the-setup-package</a></li>
</ol>

<div>If you have any feedback or questions please don’t hesitate to reach out to me at: <a href="mailto:itai.raz@redislabs.com">itai.raz@redislabs.com</a>.</div>

<p><a href="https://redislabs.com/redis-enterprise-downloads" target="_blank"><img alt="" class="aligncenter size-full wp-image-9953" height="200" src="https://redislabs.com/wp-content/uploads/2015/06/download-now.png" title="RLEC - Download Now!" width="635" /></a></p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="https://redislabs.com/blog/introduction-to-redis-labs-enterprise-cluster"> on June 08, 2015 01:00 PM</a></span>
		</div>
	</div><!-- .post -->

		<h3 id="todaysDate">April 16, 2015</h3>

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="https://redislabs.com/blog/redis-ram-ramifications-i" title="Redis Labs">Redis RAM Ramifications – Part I</a></h2>

<h3>Redis Labs</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><img alt="" class="alignnone size-full wp-image-9316" height="200" src="https://redislabs.com/wp-content/uploads/2015/04/2015-04-16.jpg" title="A Poor Man Pegasus: An African swallow carrying a coconut" width="635" /></p>

<blockquote>
	<p style="text-align: right;">"…as we know, there are known knowns; there are things we know we know. We also know there are known unknowns; that is to say we know there are some things we do not know. But there are also unknown unknowns – the ones we don't know we don't know."</p>

	<p style="text-align: right;">United States Secretary of Defense Donald Rumsfeld, 2002</p>
</blockquote>

<h3 dir="ltr">How much RAM does Redis need?</h3>

<p dir="ltr">If there's one most often repeated Redis question, it's this one. It's also one of the hardest to answer accurately because the answer depends on oh-so-many factors. In this post (and most likely a few upcoming ones as I do tend to ramble while I rumble and mumble), I'll try mapping out Redis' RAM consumption. While I can't guarantee an ultimate answer to everything, I hope it'll help to:</p>

<ul>
	<li dir="ltr">Repeat what we know about the known knowns (<em>KK</em>s)</li>
	<li dir="ltr">Turn known unknowns (<em>KU</em>s) into KKs when possible, or at least into known roughly-understood unknowns (<em>KRUU</em>s)</li>
	<li dir="ltr">Hopefully stumble on some unknown unknowns (<em>UU</em>s), and turn them into KUs, KRUUs or even KKs!</li>
</ul>

<p dir="ltr"><em><strong>Side note:</strong> you can track my progress on this series by subscribing to the <a href="https://redislabs.com/blog/feed" target="_blank">RSS feed</a>. Alternatively, sign up to <a href="https://redislabs.com/redis-watch-archive" target="_blank">Redis Watch</a> and get weekly updates delivered to your inbox. Lastly, but only if you're up to it, <a href="https://twitter.com/redislabsinc" target="_blank">follow us</a> on Twitter for real-time action.</em></p>

<p dir="ltr">So, Redis is a piece of software and as such it requires RAM to operate. But Redis is not just any software, it is an in-memory database, which means that every piece of data Redis manages is kept in RAM too. Lets call the RAM that Redis needs to operate the <em>Operational RAM</em>, and name the RAM used for data storage the <em>User Data RAM</em>.</p>

<h3>What is the airspeed velocity of an unladen swallow?</h3>

<p><img alt="" class="alignleft size-full wp-image-9325" height="165" src="https://redislabs.com/wp-content/uploads/2015/04/Bridge_of_Death_monty_python_and_the_holy_grail_300x200.jpg" style="margin-bottom: 0px;" title="Bridge of Death, Monty Python and the Holy Grail" width="300" />We'll begin our journey with a quick peek at Redis' Operational RAM.</p>

<p>It is used for many purposes and tasks that Redis performs, and one way to think of that chunk of RAM is as all the memory that's used by Redis for everything that isn't the user's data (I'll probably waddle knee-deep into this later on) Redis' RAM footprint is influenced by a myriad of deployment factors, including:</p>

<ul>
	<li dir="ltr">The server processor's architecture</li>
	<li dir="ltr">The operating system</li>
	<li dir="ltr">Redis' version and configuration</li>
	<li dir="ltr">Probably a lot moar KKs, KUs and UUs</li>
</ul>

<p dir="ltr">We can easily, however, set a baseline for Redis' operational RAM requirements by examining it at rest on a typical server. For example, the memory footprint of <a href="http://www.imdb.com/title/tt0071853/quotes" target="_blank">unladen African swallow</a> v3.0.0 instance on a virtualized Ubuntu 14 64-bit server is 7995392 bytes (or about 7.6MB). You can quickly determine how much total RAM your Redis instance has allocated from the command line with <span style="font-family: courier new,courier,monospace;">ps</span>' RSS column, or with Redis' <a href="http://redis.io/commands/info" target="_blank"><span style="font-family: courier new,courier,monospace;">INFO</span></a> command:</p>

<pre style="margin-left: 40px;">foo@bar:~$ uname -a
Linux bar 3.13.0-49-generic #81-Ubuntu SMP Tue Mar 24 19:29:48 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
foo@bar:~$ ps aux | grep redis-server
foo 20139 0.0 0.1 42304 7808 pts/1 Sl+ 19:18 0:00 ./redis-server *:6379
foo 20143 0.0 0.0 15940 944 pts/9 S+ 19:18 0:00 grep --color=auto redis-server
foo@bar:~$ redis-cli INFO memory | grep used_memory_rss
used_memory_rss:7995392</pre>

<p><em><strong>Side note:</strong> the results of from the two methods above </em><em style="line-height: 20.7999992370605px;">and others </em><em>may not always be the same. Also, note that used_memory_rss differs greatly from Redis' used_memory as we'll see.</em></p>

<p dir="ltr">Since this is a freshly initialized Redis instance, we can assume that this figure is a fair representation of our operational baseline. Redis' operational RAM can grow, even significantly, but lets not worry about that for now.</p>

<h3 dir="ltr">What? A swallow carrying a coconut?</h3>

<p dir="ltr"><a href="https://redislabs.com/blog/red-is-beautiful-a-visualization-of-redis-commands" target="_blank">Redis is beautiful</a>, but you don't keep it around just for its pretty face, do you? No, you make Redis manage your data because you need the fastest NoSQL database on the planet today. You let it carry your coconut and depend on it to keep beating its wings forty-three times (so close!) every second. So how much RAM does user data take? That depends on the coconut :)</p>

<p dir="ltr">Redis' schemaless schema* is based on the Key-Value model. Every user datum that Redis manages is primarily a KV pair. It doesn't take a genius to understand that the longer/bigger your keys and values are, the more RAM Redis will need to store it. But Redis does have a few ingenious tricks designed to keep data compacted and organized.</p>

<p dir="ltr"><em>* There is no such as a schemaless database – at most it can have only an implicit one.</em></p>

<p dir="ltr">Let's jump right into it with an example concerning the simplest Redis data type – consider the following:</p>

<pre style="margin-left: 40px;">127.0.0.1:6379&gt; SET swallow coconut
OK</pre>

<p dir="ltr">How much RAM did we just use? Since all data is organized by keys, the key's name is the first element we'll examine. We know that Redis key names are binary safe strings that can be up to 512MB long. Cool. String values in Redis are also binary safe and up to 0.5GB, so in our example above we can assume 7 bytes for "swallow" and another 7 bytes for the "coconut"… and we'd be wrong, at least partially. Here, let me show you:</p>

<pre style="margin-left: 40px;">127.0.0.1:6379&gt; STRLEN swallow
(integer) 7
127.0.0.1:6379&gt; DEBUG SDSLEN swallow
key_sds_len:7, key_sds_avail:0, val_sds_len:7, val_sds_avail:0
</pre>

<p dir="ltr">As shown above with <a href="http://redis.io/commands/strlen" target="_blank">STRLEN</a>, Redis insists that the length of the value ("coconut") that's stored under the "swallow" key is 7 bytes long. Even more so, the "secret" DEBUG SDSLEN command also makes the same claims, but what both don't account for is the datum's overhead, and every Redis data structure comes with its own baggage. That means that besides the actual strings ("swallow" and "coconut"), Redis also needs some RAM to manage them.</p>

<p dir="ltr">Since every key-value tuple in Redis uses additional RAM for its internal bookkeeping, and because the amount of that RAM depends on the data structure and the data itself, I consider this overhead, while meta, a part of the user data. Put differently, if for every X bytes string Redis requires X + Y bytes, then Y is definitely a KU that I'd like to make into a KK.</p>

<h3 dir="ltr">String theory</h3>

<p dir="ltr">Strings in Redis are largely implemented by one of <strong>Salvatore Sanfilippo @antirez</strong>'s sub-projects, called <a href="https://github.com/antirez/sds" target="_blank">sds</a> (or Simple Dynamic Strings library for C). While sds strings bring a lot of power and ease of use to Redis internally, they do carry some overhead with them as an sds string is made up of:</p>

<pre style="margin-left: 40px;">+--------+-------------------------------+-----------+
| Header | Binary safe C alike string... | Null term |
+--------+-------------------------------+-----------+
         |
         `-&gt; Pointer returned to the user.
</pre>

<p dir="ltr">(diagram courtesy of antirez, <a href="https://github.com/antirez/sds/blob/master/README.md" target="_blank">https://github.com/antirez/sds/blob/master/README.md</a>)</p>

<p dir="ltr">The size of an sds string's header (<a href="https://github.com/antirez/redis/pull/2509" target="_blank">at the moment</a>) is 8 bytes and the null character is an additional byte, which give us a total of 9 bytes overhead per string. The 7 byte long "swallow" suddenly takes more than twice that amount – 16 bytes of RAM – to store in Redis!</p>

<p dir="ltr"><em><strong>Side note:</strong> It actually uses moar. The reference to every key is also stored in Redis' keyspace hash table, which in turn requires even more RAM… And there's also the robj "object" that Redis uses to facilitate some stuff like LRU… But let's just keep the key's management RAM overhead as a KU and throw it into the operational RAM side of the house for now :)</em></p>

<h3 dir="ltr">…four really, if they had the coconut on a line between them</h3>

<p dir="ltr">Back to our swallows and coconuts – so now we know that Redis will use 36 bytes for storing the two strings that make up the key and value in the example above, but is that all? Let's take a closer look at our coconut:</p>

<pre style="margin-left: 40px;">127.0.0.1:6379&gt; OBJECT ENCODING swallow
"embstr"
</pre>

<p dir="ltr">The plot thickens (or maybe it's the coconut growing hair?). This cryptic response begs an explanation, but are all coconuts encoded the same? Let's try carrying a few different shapes of string coconuts and see:</p>

<pre style="margin-left: 40px;">127.0.0.1:6379&gt; SET swallow:0 "0"
OK
127.0.0.1:6379&gt; SET swallow:1 "An oversized and thickly-haired coconut"
OK
127.0.0.1:6379&gt; SET swallow:2 "Ok, this is the mother of all coconuts - it is something that would make Donkey Kong run back to his mama in tears"
OK
127.0.0.1:6379&gt; OBJECT ENCODING swallow:0
"int"
127.0.0.1:6379&gt; OBJECT ENCODING swallow:1
"embstr"
127.0.0.1:6379&gt; OBJECT ENCODING swallow:2
"raw"
</pre>

<p dir="ltr">Each of our coconuts is different, so Redis uses different encodings. The "int" encoding is used to efficiently store integer values between <em>LONG_MIN</em> and <em>LONG_MAX</em> (as defined in your environment's <em>limits.h</em>) and also leverages the shared.integers construct to avoid duplicating data. Consequently, these take up less space. On the other hand, strings longer than 39 bytes are stored as "raw", whereas shorter ones use the "embstr" encoding (the magic number is defined by <em>REDIS_ENCODING_EMBSTR_SIZE_LIMIT</em> in <em>redis.h</em>).</p>

<h3 dir="ltr">Going (coco)nuts</h3>

<p><img alt="" class="alignright size-full wp-image-9333" height="200" src="https://redislabs.com/wp-content/uploads/2015/04/coconuts.jpg" style="margin-bottom: 0px;" title="coconuts" width="300" />What about other coconut structures? Strings are the simplest data structure that Redis offers and they are used internally to make other, more advanced structures. The Hash is made of a bunch of Strings (fields &amp; values) added with a dictionary data structure, in which each entry is a linked list… BUT they could be encoded entirely as a ziplist. And speaking of lists, we have the linked lists and ziplists (and perhaps even <strong>Matt Stancliff @mattsta</strong>'s <a href="https://matt.sh/redis-quicklist-visions" target="_blank">quicklists</a> soon) that are also used by Sets and Sorted Sets…</p>

<p>I could go on, <strong>indefinitely</strong>, into the delicate intricacies of data encoding in Redis and how they affect memory consumption. I fear, however, that it will bore all of us to death pretty soon. Alternatively, you can <em>git checkout</em> the <a href="https://github.com/antirez/redis" target="_blank">source code</a> and start reading it – I know a few people who have done it, but you'll need a certain level of programming skills for that.</p>

<p>Which still leaves the big KU – <em>How much RAM does Redis need?</em> – and its little brother KU – <em>How much RAM do coconuts need?</em> – pretty much unanswered. But where there's a will there's a way. Feel free to interact with me via the usual channels – I'm Highly-Available :)</p>

<p><em><strong>Side note:</strong> to be continued.</em></p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="https://redislabs.com/blog/redis-ram-ramifications-i"> on April 16, 2015 04:11 PM</a></span>
		</div>
	</div><!-- .post -->

		<h3 id="todaysDate">January 13, 2015</h3>

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="https://redislabs.com/blog/rdb-merger-merge-and-convert-redis-rdb-files" title="Redis Labs">rdb-merger: Merge and Convert Redis RDB Files</a></h2>

<h3>Redis Labs</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p dir="ltr"><img alt="" class="alignnone size-full wp-image-8086" height="200" src="https://redislabs.com/wp-content/uploads/2015/01/rdb-merger_art.png" title="rdb-merger" width="635" /></p>

<p dir="ltr">If you're using Redis you probably already know all about its data persistence mechanisms, namely Append-Only-Files (AOF) and RDB files, but if you need a refresher take a few minutes and read <a href="http://redis.io/topics/persistence" target="_blank">this documentation page</a> and <a href="http://oldblog.antirez.com/post/redis-persistence-demystified.html" target="_blank">this blog post</a> to get up to speed quickly. Already back? Good. Now, imagine you have multiple RDB files that you want to merge – how would you do that?</p>

<p>RDB files essentially contain a snapshot of your Redis database. They provide a convenient and compact (as they are compressed) way to backup your dataset and schlep it around from one place to another. Redis can be configured to automatically take snapshots (with the <span style="font-family: courier new,courier,monospace;">save</span> configuration directive) or you can <span style="line-height: 20.7999992370605px;">manually</span><span style="line-height: 20.7999992370605px;"> </span><span style="line-height: 1.6;">trigger their creation with the </span><a href="http://redis.io/commands/save" style="line-height: 1.6;" target="_blank"><span style="font-family: courier new,courier,monospace;">SAVE</span></a><span style="line-height: 1.6;">/</span><span style="line-height: 1.6; font-family: 'courier new', courier, monospace;"><a href="http://redis.io/commands/bgsave" target="_blank">BGSAVE</a> </span><span style="line-height: 1.6;">commands. Alternatively, you can create an RDB file from a remote Redis server with the </span><span style="line-height: 1.6; font-family: 'courier new', courier, monospace;">redis-cli –rdb</span><span style="line-height: 1.6;"> tool and switch. Redis will also load an RDB file upon startup (when configured to do so with the </span><span style="line-height: 1.6; font-family: 'courier new', courier, monospace;">dir</span><span style="line-height: 1.6;"> and </span><span style="line-height: 1.6; font-family: 'courier new', courier, monospace;">dbfilename</span><span style="line-height: 1.6;"> directives) and will restore the contents of the database from it.</span></p>

<p>Redis creates a single RDB file per Redis server – all shared, a.k.a. numbered, databases are included in that file since they are only logical namespaces inside the same databases (BTW you should really avoid using shared databases – <a href="https://redislabs.com/blog/benchmark-shared-vs-dedicated-redis-instances" target="_blank">here's why</a>). There are cases, however, when you want to take several such RDBs and merge their contents into a single file. The classic use case for this is when your Redis database is sharded across multiple Redis servers, each managing a subset of the keyspace.</p>

<p>One possible approach to merging Redis databases, using RDB files, is to:</p>

<ol>
	<li dir="ltr">Export each of the databases' contents to a text file – You can do that using a custom script or the incredibly useful <a href="https://github.com/sripathikrishnan/redis-rdb-tools" target="_blank">redis-rdb-tools</a>.</li>
	<li dir="ltr">Process the resulting text files and concatenate them to a single text file.</li>
	<li dir="ltr">Load the single text file back into Redis (again using a script or similar).</li>
</ol>

<p>While this approach works just fine it is potentially resource intensive, time consuming and cumbersome. What if you could use your existing RDB files and skip the export stage? What if you could have the merged result as an RDB file and have Redis load it efficiently on startup? Well, with <span style="font-family: courier new,courier,monospace;">rdb-merger</span> you can.</p>

<p><span style="font-family: courier new,courier,monospace;">rdb-merger</span> is a small utility that I've developed to do just that – it accepts multiple RDB files as its input and merges them into a single output file. Using it is as simple as running the following command:</p>

<p style="margin-left: 40px;"><span style="font-family: courier new,courier,monospace;">rdb-merger -o outfile.rdb infile1.rdb infile2.rdb</span></p>

<p>In the example above, <span style="font-family: courier new,courier,monospace;">rdb-merger</span> will create an output file called <span style="font-family: courier new,courier,monospace;">outfile.rdb</span> from two input files: <span style="font-family: courier new,courier,monospace;">infile1.rdb</span> and <span style="font-family: courier new,courier,monospace;">infile2.rdb</span>. The full usage for rdb-merger can be obtained by running it with the <span style="font-family: courier new,courier,monospace;">-h</span> flag:</p>

<p style="margin-left: 40px;"><span style="font-family: courier new,courier,monospace;">rdb-merger [-h] [-c redis_conf.conf] [-p] -o output_file.rdb input_file.rdb [input_file.rdb ...]</span></p>

<p>The <span style="font-family: courier new,courier,monospace;">-o</span> switch is mandatory and specifies the output file. Replace it with a single dash ('-') to direct the output to <span style="font-family: courier new,courier,monospace;">stdout</span>. Use the <span style="font-family: courier new,courier,monospace;">-c redis_conf.conf</span> switch to specify the name of a Redis configuration file that will be used during the merger (it can include, for example, different <span style="font-family: courier new,courier,monospace;">*-ziplist-*</span> or <span style="font-family: courier new,courier,monospace;">rdbcompression</span> settings to perform a conversion of the input files). Using the <span style="font-family: courier new,courier,monospace;">-p</span> switch will instruct <span style="font-family: courier new,courier,monospace;">rdb-merger</span> to print the progress percentage to <span style="font-family: courier new,courier,monospace;">stderr</span> during its execution.</p>

<p><strong>Important note:</strong> <span style="font-family: courier new,courier,monospace;">rdb-merger</span> does not check for the correctness of the outputted RDB file. That means that if two or more of your input RDBs contain the same key names, the result will not be a valid RDB file and Redis will not be able to load it.</p>

<p><span style="font-family: courier new,courier,monospace;">rdb-merger</span> is currently a part of Redis Labs' <a href="https://github.com/RedisLabs/redis" target="_blank">Redis fork at GitHub</a>. To use it, you'll have to download the sources and run <span style="font-family: courier new,courier,monospace;">make</span> to build Redis. Use it to make the One RDB file to "rule them" all and let me know if you encounter any <a href="https://github.com/RedisLabs/redis/issues" target="_blank">issues</a>.</p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="https://redislabs.com/blog/rdb-merger-merge-and-convert-redis-rdb-files"> on January 13, 2015 01:32 PM</a></span>
		</div>
	</div><!-- .post -->

		<h3 id="todaysDate">December 31, 2014</h3>

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="https://redislabs.com/blog/pop-the-red-boxs-lid-redis-lua-debugger" title="Redis Labs">Pop the Red Box’s Lid: Redis Lua Debugger</a></h2>

<h3>Redis Labs</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><img alt="" class="alignnone size-full wp-image-7879" height="200" src="https://redislabs.com/wp-content/uploads/2014/12/rld_art.png" title="Redis Lua Debugger" width="635" /></p>

<p>Imagine a red box. You put something in the box and wait for something else to come out (or not). Whatever comes out (or not) of the box depends entirely on what you told the box you wanted it to do. The box originated from <a href="http://antirez.com/news/57" target="_blank">Terrah</a>'s moon so it only understands moon-language, a language that's both foreign and at the same time similar to what you're already used to. For it to do your bidding, you need to explain everything you want it to do in meticulous details, or else the box doesn't work at all. When the box does work, what you get back isn't always what you thought you'd get. The red box has a wry sense of humor and appears to thrive on your growing frustration as you try peeping inside its workings to understand what went wrong.</p>

<p>This is how I sometimes felt when trying to write even the most trivial Redis Lua scripts. It's not that the box is broken, not at all. The problem's entirely my programmering skillz and the unique tendency I have of sprinkling bugs all over the place. I recently wrote about the <a href="https://redislabs.com/blog/5-methods-for-tracing-and-debugging-redis-lua-scripts" target="_blank">5 Methods For Tracing and Debugging Redis Lua Scripts</a>, but all of these methods (excluding the last one) require tediously adding and removing debug printouts in your code. So I found a better way to do it and the result is our Redis Lua Debugger (or just "rld"), which boasts the following features:</p>

<ul>
	<li>A fully non-interactive debugger</li>
	<li>Easy &amp; native installation, only ~6KB payload</li>
	<li>Output printing to local and remote consoles</li>
	<li>Code line execution tracing</li>
	<li>State-of-the-art automatic watch mechanism, which reports new variables and value changes</li>
	<li>Reports function calls, returns and arguments – and does on-the-fly profiling</li>
</ul>

<p>The first thing to know about the Redis Lua Debugger is that it is written in Lua and it runs in Redis. That means you don't need anything besides the script and Redis to use rld. To use rld, you'll first need to load it to your Redis by running it like any regular script – this will cause rld to burrow into your Redis' Lua environment until the next server restart or a call to <span style="font-family: courier new,courier,monospace;">SCRIPT FLUSH</span>.</p>

<p>rld can use both Redis' log file and Pub/Sub (methods 1 and 4 in the abovementioned post, respectively) for its output. To keep track with it just tail the log file and/or subscribe to the `rld` channel. Note that after you've loaded rld, it will stay dormant until explicitly activated by your Lua script and will remain active as long as the script runs or until rld is stopped.</p>

<p>So, to actually use rld for debugging your script, you'll need to switch it on by calling its `start` function – simply add the following line at the beginning of your Lua script:</p>

<p></p>

<p>Now you can run your script. It will be executed normally (or rather abnormally since we are talking about debugging after all) , but at the same time rld will be tracking it and printing information about its execution. Read the output carefully until you've arrived at that Aha!/#facepalm moment.</p>

<p>Here's an example – consider the following Lua script called prog.lua:</p>

<p></p>

<p>Now, load rld (if you haven't already) and run the script – since I'm passing 42 as the argument, I expect it to be the right answer:</p>

<p></p>

<p>Wowza! Wait! What just happened? Easy, just loog in your lok:</p>

<p></p>

<p>Can you say Halle-Lua? Isn't this really va-Lua-ble? rld can be downloaded from <a href="https://github.com/RedisLabs/redis-lua-debugger" target="_blank">https://github.com/RedisLabs/redis-lua-debugger</a>. I hope you'll find it useful at least as much as I had fun making it. Sure, there's still a lot that can be done to improve and extend rld but I feel it's already an MVP so I'm releasing it now. As for prog.lua… well, I'm still trying to remember what I forgot in order to fix it. If you spot the bug, please call tonumber: 555-1234.</p>

<p>Questions? Feedback? Feel free to email me (<a href="mailto:itamar@redislabs.com" target="_blank">itamar@redislabs.com</a>) or tweet me (<a href="https://twitter.com/itamarhaber" target="_blank">@itamarhaber</a>) about anything and everything – I'm highly avai-Lau-ble :)</p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="https://redislabs.com/blog/pop-the-red-boxs-lid-redis-lua-debugger"> on December 31, 2014 01:39 PM</a></span>
		</div>
	</div><!-- .post -->

		<h3 id="todaysDate">September 24, 2014</h3>

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://blog.pivotal.io/pivotal-cloud-foundry/news-2/an-introduction-to-the-pivotal-cf-mobile-suite-api-gateway" title="Pivotal P.O.V. » Redis">An Introduction to the Pivotal CF Mobile Suite API Gateway</a></h2>

<h3>Pivotal</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><img alt="featured-PCF-mobile" class="alignleft size-full wp-image-10327" height="200" src="http://blog.pivotal.io/wp-content/uploads/2014/08/featured-PCF-mobile.png" width="200" />The API Gateway is one of the products available on the Pivotal CF Mobile Services. It allows developers to easily create edge gateways proxy calls between devices and your organization internal services.</p>
<p>There are several reasons why one would consider having such services in place:</p>
<ul>
<li><strong>Centralized authentication</strong>: Your internal services may have different authentication mechanisms, if any, and you may want to expose a API key style of authentication to external consumers.</li>
<li><strong>Reduce chattiness</strong>: Allows mobile devices to reduce the number of calls to your backend by aggregating invocations to multiple services at once.</li>
<li><strong>Data type conversion</strong>: Internal services may have different formats such as REST or SOAP, an edge gateway can serve as a central transformation point.</li>
<li><strong>Data filtering</strong>: You can filter data either based on role based access or perhaps just for the sake of saving bandwidth to certain clients.</li>
<li><strong>Rate limiting</strong>: Control the number of requests clients can make to your services. This can avoid possible DDOS on your services as well as control access to certain billable services such as third-party services you may use.</li>
</ul>
<p>One of the benefits of using an edge gateway is that you can perform all of the above without having to modify internal services—the gateway will sit between your services and the clients. The picture below demonstrates this:</p>
<p><img alt="Screen Shot 2014-09-24 at 11.05.48 AM" class="aligncenter size-full wp-image-10604" height="1094" src="http://blog.pivotal.io/wp-content/uploads/2014/09/Screen-Shot-2014-09-24-at-11.05.48-AM.png" width="1244" /></p>
<p>Pivotal’s API Gateway uses javascript as its core language, but not your usual javascript engine. It’s powered by Nashorn, the latest JDK script engine. This approach allows developers to enjoy the benefits of using a simple script language such as javascript, while still being able to seamless integrate with Spring beans. You can invoke any Java Spring bean from your javascript code.</p>
<p>The picture below depicts the internals of a gateway application. Note that you can add your own java beans as well as javascript code.</p>
<p><img alt="Screen Shot 2014-09-24 at 11.05.58 AM" class="aligncenter size-full wp-image-10605" height="876" src="http://blog.pivotal.io/wp-content/uploads/2014/09/Screen-Shot-2014-09-24-at-11.05.58-AM.png" width="1092" /></p>
<h2>Implementing Rate Limit</h2>
<p>In this post, we will show how easy is to implement a rate limiting edge gateway service using Pivotal’s API Gateway and Redis.</p>
<p>Rate limiting is an important feature that you should consider when exposing your APIs to external users. It prevents possible DDOS on your internal services by discarding requests from customers which exceeded the maximum stipulated quota. It also allows you to have control of your billing expenses on your IaaS provider by controlling traffic and usage.</p>
<p>When it comes to rate limiting there isn’t a standard on how to deal with it, but several service providers such as <a href="https://dev.twitter.com/rest/public/rate-limiting">twitter</a> and <a href="https://developer.github.com/v3/rate_limit/" title="GitHub">github</a> utilizes a combination of HTTP response headers and an HTTP Response code 429 (too many requests) when the client quota has exceeded.</p>
<p>There are many ways of implementing rate limiting, but in a nutshell we need to be able to:</p>
<ol>
<li>Identify the caller (via an API key or IP address)</li>
<li>Log the number of requests</li>
<li>Set an expiration time for the request window (1 minute, 1 hour, 1 day)</li>
</ol>
<h2>Rate control using Redis</h2>
<p>Redis is a great choice for implementing rate limiting. It offers the capability of setting keys timeouts as well as atomic increase operations on a numeric key.</p>
<p>The pattern is actually described on the <a href="http://redis.io/commands/INCR">redis incr command</a>. We will use a slight variation of that, which allows us to control the window interval as opposed to only using a one second window.</p>
<p>Redis stores one value with a JSON configuration object for each API key in this way:</p>
<p>{<br />
“key”:”mykey”,<br />
“value”:10,<br />
“current”:null,<br />
“reset”:null,<br />
“window”:60<br />
}</p>
<p><strong>key</strong>: The API Key associated with this config<br />
<strong>value</strong>: The request limit<br />
<strong>current</strong>: The current request count for a given period (not used on configuration)<br />
<strong>reset</strong>: The Unix epoch in milliseconds of the next reset of the count<br />
<strong>window</strong>: Controls how long the counter will be held in memory</p>
<p>The above configuration creates a rate limit control that allows 10 requests per minute. Using Spring-Data-Redis, all we need is one Bean to get the information for each API request.</p>
<p>The code below shows the java spring bean we created to keep track of requests per api:</p>
<pre class="brush: plain; title: ; notranslate">package io.pivotal.api.rate;

import java.io.IOException;
import java.util.List;
import java.util.concurrent.TimeUnit;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.dao.DataAccessException;
import org.springframework.data.redis.core.RedisOperations;
import org.springframework.data.redis.core.SessionCallback;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.stereotype.Component;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;

@Component("rateLimiter")
public class RateLimiterImpl {

	@Autowired
	private StringRedisTemplate template;

	@Autowired
	private ObjectMapper mapper;

	/**
	 *  Reads the current value of a given key on a window of time. It contains both the value and next reset window
	 *  This entry is stored in redis as a key on the format : 'apikey:timewindow'
	 *
	 * */

	public Rate getCurrent(final Rate rate){
		Long now = System.currentTimeMillis();
		Long time = (Long)(now/(1000*rate.getWindow()));
		final String key = rate.getKey()+":"+time;
		List&lt;Object&gt; results = template.execute(new SessionCallback&lt;List&lt;Object&gt;&gt;() {

			@Override
			public  List&lt;Object&gt; execute(RedisOperations ops) throws DataAccessException {
				ops.multi();
				ops.boundValueOps(key).increment(1L);
				ops.expire(key, rate.getWindow(), TimeUnit.SECONDS);
				return ops.exec();
			}
		});
		Long current = (Long)results.get(0);
		rate.setCurrent(current.intValue());
		rate.setReset(time*(rate.getWindow()*1000));
		return rate;
	}
	/**
	 * Fetches the configured rate for a given API. This entry only contains the key, the window and value
	 * it does not store the value of the current invocation or the next reset window.
	 * This entry is represented in redis just by the key 'apikey'
	 *
	 * */

	public Rate getRate(String apikey){
		Rate rate = null;
		try {
			rate = mapper.readValue(template.opsForValue().get(apikey), Rate.class);
			rate = getCurrent(rate);
		} catch (IOException e) {
			e.printStackTrace();
		}
		return rate;
	}

	public void setRate(Rate rate){
		try {
			template.opsForValue().set(rate.getKey(), mapper.writeValueAsString(rate));
		} catch (JsonProcessingException e) {
			e.printStackTrace();
		}
	}
}
</pre>
<p>For sake of simplicity, we use the same JSON object to represent the configuration for a given API—for example, the number of requests and the window duration—as well as the current value for that instance in time.</p>
<p>We use two separate keys to store this. For the configuration, it’s a key that has not ttl and its stored using the apikey as the key. For the current value, we store using apikey:window as the key and we set a TTL on it.</p>
<p>For each call we create an unique key composed of the API key plus the current time divided by the rate window. This will give an unique key for each window of invocation. On each call we increment the key and increase its time to live by the rate window.</p>
<p>When the time window expires we generate a new key with a zero counter, the old key would still live for as long as the length of the window, but since it would never be refreshed, Redis will eventually expire it.</p>
<h2>Javascript meets Java</h2>
<p>As mentioned before, one of the greatests features of API Gateway is the ability to mesh Javascript code with Java. Writing your application in Javascript will allow you to leverage the simplicity of the language, and its great support for JSON. This reduces quite significantly the amount of boilerplate that would be needed to write APIs, while allowing you to access your java backend components as first class citizens.</p>
<p>API Gateway has a native spring global function that allows you to invoke any spring bean that is part of your application. Using this feature we can easily access our RateLimiter service bean.</p>
<p>To enable the rate limit for any request to this API endpoint we’ve created a decorator around the original Router that checks for the limits of each request:</p>
<pre class="brush: plain; title: ; notranslate">var RatedRouter = function(router) {
	this.router = router;
}

function getApiKey(req){
	var header = req.headers["Authorization"];
	return header.split(" ")[1];
}

function checkLimit(req,res){
	var api = getApiKey(req);
	var rate = spring.getBean("rateLimiter").getRate(api);
	var remaining = rate.value-rate.current;
	console.log(JSON.stringify(rate));
	res.setHeader("X-RateLimit-Limit",rate.value);
	res.setHeader("X-RateLimit-Remaining", remaining);
	res.setHeader("X-RateLimit-Reset",rate.reset);
	return (remaining &gt; 0);
}

RatedRouter.prototype = {

	get: function(path, handle){
		this.router.get(path, function(req, res){
			if(!checkLimit(req,res)){
				res.setStatus(429);
			}else{
				handle(req,res);
			}
		});
	},
	post: function(path, handle){
		this.router.post(path, function(req, res){
			if(!checkLimit(req,res)){
				res.setStatus(429);
			}else{
				handle(req,res);
			}
		});
	},

	put: function(path, handle){
		this.router.put(path, function(req, res){
			if(!checkLimit(req,res)){
				res.setStatus(429);
			}else{
				handle(req,res);
			}
		});
	},

	delete : function(path, handle){
		this.router.delete(path, function(req, res){
			if(!checkLimit(req,res)){
				res.setStatus(429);
			}else{
				handle(req,res);
			}
		});
	}

}

module.exports = RatedRouter
</pre>
<p>The checkLimit function will retrieve the limits for this request, and add the proper X-Rate-Limit headers to each response.</p>
<p>Each method on this router will check if the limit was reached and return a 429 (Too Many Requests) empty response if true, or just invoke the original handler that was passed to it (with the enhanced headers).</p>
<p>To demonstrate this new rate limited router, we will modify the http client sample (<a href="https://github.com/cfmobile/api-gateway-samples/tree/master/sample-http" target="_blank">see here</a>) and make sure that the calls to the external endpoint now have rate limiting enabled.</p>
<pre class="brush: plain; title: ; notranslate">var Router = require("Router");
var RatedRouter = require("modules/RatedRouter")
var _router = new Router();
var appRouter = new RatedRouter(_router);

var fbGraphClient = require('http')({
	baseUrl : 'http://graph.facebook.com/',
});

appRouter.get("/fb/pivotal", function(req, res) {
	var result = fbGraphClient.getJSON('pivotalsoftware', function(response) {
		return {
			reponse_code_from_fb : response.statusCode,
			data_from_fb : response.body
		};
	});
	res.setBody(result);
});

module.exports = _router;
</pre>
<p>The new script is exact the same as the one on the samples, but now calls respect a limit that is stored on your redis database.</p>
<p>To test it out, let’s create a script that tries to invoke this endpoint 11 times in windows of less than 60 seconds.</p>
<pre class="brush: plain; title: ; notranslate">for i in {1..11}; do curl -i -H "Authorization: apikey mykey" http://localhost:8080/api/v1/fb/pivotal;  done

HTTP/1.1 200 OK
X-Application-Context: application:9999
X-RateLimit-Limit: 10
X-RateLimit-Remaining: 9
X-RateLimit-Reset: 1410442320000
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Server: Jetty(8.1.15.v20140411)

{hidden response body}

HTTP/1.1 200 OK
X-Application-Context: application:9999
X-RateLimit-Limit: 10
X-RateLimit-Remaining: 8
X-RateLimit-Reset: 1410442320000
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Server: Jetty(8.1.15.v20140411)
.
.
.
HTTP/1.1 429 429
X-Application-Context: application:9999
X-RateLimit-Limit: 10
X-RateLimit-Remaining: 0
X-RateLimit-Reset: 1410442320000
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Server: Jetty(8.1.15.v20140411)
</pre>
<p>As you can see after the 10th call the server stops forwarding requests to the fbClient service and returns 429. The client receives a X-RateLimit-Reset header that informs when it would be ok to call the service again.</p>
<h2>Summary</h2>
<p>This post was intended to demonstrate how easy it is to add features to your edge gateway when using Pivotal’s API Gateway. With very few lines of code we were able to enable rate limiting to our internal services without having to change any existing component.</p>
<p>The seamless integration between javascript and java puts the best of both languages at your disposal. You can still rely on enterprise grade components built using Spring Framework, while leveraging a dynamic scripting language running on an asynchronous framework that the API Gateway provides.</p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://blog.pivotal.io/pivotal-cloud-foundry/news-2/an-introduction-to-the-pivotal-cf-mobile-suite-api-gateway"> on September 24, 2014 04:31 PM</a></span>
		</div>
	</div><!-- .post -->

		<h3 id="todaysDate">September 05, 2014</h3>

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://blog.pivotal.io/pivotal/products/easy-pivotal-app-installs-rpm-deb-msi-brew-chef-puppet-and-more" title="Pivotal P.O.V. » Redis">Easy Pivotal App Installs: RPM, deb, MSI, BREW, Chef, Puppet, and More</a></h2>

<h3>Pivotal</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><a href="http://blog.pivotal.io/wp-content/uploads/2014/09/featured-packaging-deployment-monitoring.png"><img alt="featured-packaging-deployment-monitoring" class="alignleft size-full wp-image-10543" height="200" src="http://blog.pivotal.io/wp-content/uploads/2014/09/featured-packaging-deployment-monitoring.png" width="200" /></a>In the current software development world, deployment automation and cloud monitoring are pushing all of us to use tools like RPM, deb, MSI, Homebrew, Chef, and Puppet for deployment and solutions like Hyperic and New Relic for monitoring.</p>
<p dir="ltr">With this in mind, Pivotal provides packaging that streamlines the development, deployment, and scale of modern applications across public and private infrastructure. In this blog post, we highlight these specific offerings that facilitate middleware deployment and monitoring. Pivotal’s packaging engineering team has created OS-native install packages for the most popular operating systems as well as the leading provisioning automation platforms.</p>
<p>In this blog post, we cover deployment and monitoring of Pivotal App Suite’s Commercial and OSS middleware products on most popular OS platforms so that anyone can use familiar methods to quickly and accurately install and configure components of the <a href="http://www.pivotal.io/products/pivotal-app-suite" target="_blank" title="Pivotal App Suite">Pivotal App Suite</a>. The following commercial and open source projects are covered:</p>
<p><strong>Commercial Products</strong></p>
<ul>
<li><a href="http://www.pivotal.io/products/pivotal-tc-server" target="_blank" title="Pivotal tc Server">Pivotal tc Server</a> – with Spring Insight, Gemfire Session, and Hibernate caching</li>
<li><a href="http://www.pivotal.io/products/pivotal-rabbitmq" target="_blank" title="Pivotal RabbitMQ">Pivotal RabbitMQ</a> – includes the JMS client</li>
<li><a href="http://www.pivotal.io/products/pivotal-web-server" target="_blank" title="Pivotal Web Server">Pivotal Web Server</a> – includes the APR connector for Tomcat &amp; tc Server</li>
</ul>
<p><strong>Open Source Projects</strong></p>
<ul>
<li><a href="http://redis.io" target="_blank" title="Redis">Redis</a></li>
<li><a href="http://rabbitmq.com" target="_blank" title="RabbitMQ">RabbitMQ</a></li>
<li><a href="http://projects.spring.io/spring-xd/" target="_blank" title="Spring XD">Spring XD</a></li>
</ul>
<h2><strong>About the Pivotal App Suite Installers</strong></h2>
<p>Pivotal App Suite commercial products are available in many binary formats and supported on every major production and developer platform. The Pivotal engineering team has made installation a priority—making the experience lightweight and convenient for our customers and partners.</p>
<p>In most cases, you can install and get Pivotal App Suite products running with couple of commands. Pivotal provides public <a href="http://en.wikipedia.org/wiki/Yellowdog_Updater,_Modified" target="_blank" title="YUM">YUM</a> and <a href="http://en.wikipedia.org/wiki/Advanced_Packaging_Tool" target="_blank" title="APT">APT</a> repositories for easy installation of Pivotal App Suite products on popular Linux platforms (RHEL, CentOS, and Ubuntu), Windows MSI installers for Windows server and desktop platforms, and a <a href="http://brew.sh" target="_blank" title="Homebrew">Homebrew tap</a> for Mac OSX.</p>
<h2><strong>Installers</strong></h2>
<h3><strong>RHEL/CentOS</strong></h3>
<p>For RHEL and CentOS platforms, Pivotal App Suite products are available in RPM binaries and can be downloaded and installed manually from the <a href="https://network.pivotal.io" target="_blank" title="Pivotal Network">Pivotal Network</a>. But the recommended way is to use Pivotal’s yum repository to install on command line and automate upgrades. If you use Puppet or Chef there’s even better way to manage installation. Later we will also show you where to access our Puppet modules and Chef cookbooks.</p>
<p>To configure Pivotal’s yum repository as user root:<br />
<code> wget -q -O - packages.pivotal.io | sh</code></p>
<p>To configure Pivotal yum repository as an unprivileged user using sudo:<br />
<code>wget -q -O - packages.pivotal.io | sudo sh</code></p>
<p>Once you have the repository configured you can search and install Pivotal App Suite products:<br />
<code>yum search pivotal</code></p>
<p><code>sudo yum install pivotal-tc-server-standard<br />
sudo yum install pivotal-web-server<br />
sudo yum install pivotal-rabbitmq-server<br />
sudo yum install pivotal-redis<br />
sudo yum install spring-xd</code></p>
<p>Service scripts are provided and registered with chkconfig. By default the services will not start at boot. To change this behavior use chkconfig such as this:<br />
<code>chkconfig --level 35 rabbitmq-server on</code></p>
<p>This example configures rabbitmq-server to start on runlevels 3 and 5.</p>
<p>Pivotal App Suite products are installed under /opt/pivotal and processes run under unprivileged users which all use the pivotal group. Pivotal tc Server Standard and Pivotal Web Server require instances to be configured. For documentation on how to create instances and for specifics on other packages see these links:</p>
<ul>
<li><a href="http://tcserver.docs.pivotal.io/doc/30/index.html#getting-started/src/install.html#install-standard-rpm" target="_blank" title="Pivotal tcServer Standard "><b>Pivotal tc Server Standard</b></a></li>
<li><a href="http://webserver.docs.pivotal.io/doc/60/index.html#web-server/src/install.html#install-rpm" target="_blank" title="Pivotal Web Server "><b>Pivotal Web Server</b></a></li>
<li><a href="http://rabbitmq.docs.pivotal.io/doc/33/index.html#getstart/src/install-getstart.html#install-RHEL" target="_blank" title="RabbitMQ"><b>RabbitMQ</b></a></li>
<li><a href="http://redis.docs.pivotal.io/doc/2x/index.html#getting-started/src/install.html#topic_q3g_vzs_yn" target="_blank" title="Redis"><b>Redis</b></a></li>
<li><a href="http://docs.spring.io/spring-xd/docs/1.0.0.RELEASE/reference/html/#_redhat_centos_installation" target="_blank" title="Spring XD"><b>Spring XD</b></a></li>
</ul>
<h3><strong>Debian/Ubuntu</strong></h3>
<p>Add Pivotal APT repository as user root:<br />
<code>wget -q -O - packages.pivotal.io | sh</code></p>
<p>Add Pivotal APT repository as an unprivileged user using sudo:<br />
<code>wget -q -O - packages.pivotal.io | sudo sh</code></p>
<p>Search and install Pivotal App Suite products<br />
<code>apt-cache search pivotal</code></p>
<p><code>sudo apt-get install pivotal-tc-server-standard<br />
sudo apt-get install pivotal-web-server<br />
sudo apt-get install rabbitmq-server<br />
sudo apt-get install pivotal-redis</code></p>
<p>Service scripts are provided. Only rabbitmq-server starts automatically upon installation. Pivotal-tc-server-standard and pivotal-webserver require instances to be created prior to configuring startup runlevels. To enable startup upon boot use update-rc.d such as this:<br />
<code>update-rc.d pivotal-redis-6379 defaults</code></p>
<p>This example configures the default pivotal-redis instance to start on runlevels 2-5. Pivotal App Suite products are installed under /opt/pivotal and processes run under unprivileged users which all use the pivotal group.</p>
<p>For documentation specific to these packages see these links:</p>
<ul>
<li><a href="http://tcserver.docs.pivotal.io/doc/30/index.html#getting-started/src/install.html#install-standard-deb " target="_blank" title="Pivotal tcServer Standard"><b>Pivotal tcServer Standard</b> </a></li>
<li><a href="http://webserver.docs.pivotal.io/doc/60/index.html#web-server/src/install.html#install-debian" target="_blank" title="Pivotal Web Server"><b>Pivotal Web Server</b></a></li>
<li><a href="http://rabbitmq.docs.pivotal.io/doc/33/index.html#getstart/src/install-getstart.html#install-deb" target="_blank" title="RabbitMQ"><b>RabbitMQ</b></a></li>
<li><a href="http://redis.docs.pivotal.io/doc/2x/index.html#getting-started/src/install.html#topic_elr_5qr_h4" target="_blank" title="Redis"><b>Redis</b></a></li>
</ul>
<h3><strong>Mac OSX</strong></h3>
<p>Assuming you have already installed <a href="http://brew.sh" target="_blank" title="Homebrew">Homebrew</a>, add Pivotal’s homebrew tap.<br />
<code>brew tap pivotal/tap</code></p>
<p>Install Pivotal App Suite Products and more<br />
<code>brew install tcserver<br />
brew install rabbitmq<br />
brew install redis<br />
brew install springxd<br />
brew install springboot<br />
brew install gemfire</code></p>
<p>Additional information for Pivotal’s Homebrew tap is available at <a href="https://github.com/pivotal/homebrew-tap">https://github.com/pivotal/homebrew-tap</a>.</p>
<h3><strong>Windows</strong></h3>
<p>For Windows we provide MSI package file formats for tc Server, Web Server and RabbitMQ. Windows installers can be downloaded from <a href="https://network.pivotal.io" target="_blank" title="Pivotal Network">Pivotal Network</a>.</p>
<h2><strong>Configuration and Deployment Management</strong></h2>
<p>For users already familiar with DevOps tools we have open sourced Puppet modules and Chef cookbooks for configuration and management of Pivotal App Suite. Both Chef and Puppet help automate software configuration and deployment for single or thousands of nodes. The starter scripts for both DevOps tools can help you automate the deployment and management of Pivotal App Suite products quickly.</p>
<h3><strong>Puppet</strong></h3>
<p>Pivotal App Suite products can be deployed and managed using Puppet. Modules for Pivotal App Suite products are available under following Github repository. Modules make use of Pivotal’s yum and apt-get repositories so you won’t have to search for App Suite binaries or download and install them manually.</p>
<p><a href="https://github.com/pivotal/app-manage/tree/master/puppet">https://github.com/pivotal/app-manage/tree/master/puppet</a></p>
<h3><strong>Chef</strong></h3>
<p>Pivotal App Suite products can be deployed and managed using Chef. Cookbooks for Pivotal App Suite products are available under following Github repository. The repo is organized by product name. Each product folder had a README file describing how to use the cookbook and the actions it provide. Similar to Puppet modules, cookbooks are tied to Pivotals yum and apt-get repositories so you won’t have to search for App Suite binaries or download and install them manually.</p>
<p><a href="https://github.com/pivotal/app-manage/tree/master/chef-repo">https://github.com/pivotal/app-manage/tree/master/chef-repo</a></p>
<h2><strong>Monitoring</strong></h2>
<p>Pivotal App Suite products expose extensive monitoring metrics through JMX, BMX and HTTP API interface. These metrics can be viewed via native UI plugins or external monitoring systems such as Hyperic and NewRelic.</p>
<h3><strong>Hyperic</strong></h3>
<p>VMware vCenter Hyperic monitors operating systems, middleware, and applications running in physical, virtual and cloud environments. Pivotal App Suite Products have Hyperic Agent plugins to monitor health of the product. Hyperic provides a single console with powerful dashboards from which you can easily check the health of your applications and underlying infrastructure. Plugins for tc Server, Web Server and RabbitMQ Server are distributed with Hyperic Server.</p>
<h3><strong>Pivotal tc Server</strong></h3>
<p>VMware vCenter Hyperic can manage the lifecycle of tc Runtime instances by starting, stopping, and restarting local or remote instances. In addition to health metrics Pivotal tc Server includes a full set of diagnostic features that make it easy to troubleshoot problems with tc Runtime instances and the applications that you deploy to them. For each diagnostic feature, the tc Server Hyperic plug-in has one or more corresponding preconfigured alerts.<br />
Additional details on monitoring configuration and metrics are available at:</p>
<p><a href="http://tcserver.docs.pivotal.io/doc/30/index.html#getting-started/src/tuthyperic.html">http://tcserver.docs.pivotal.io/doc/30/index.html#getting-started/src/tuthyperic.html</a></p>
<h3><strong>Pivotal Web Server</strong></h3>
<p>BMX is an Apache HTTPD framework that provides internal runtime information (performance metrics, status, configuration, and current capacity) that is consumed by Pivotal Hyperic Agent. The agent monitor the health of Pivotal Web Server instances by running BMX queries to gather metrics and configuration information.</p>
<p>Additional details on monitoring configuration and metrics are available at:</p>
<p><a href="http://webserver.docs.pivotal.io/doc/60/index.html#web-server/src/config.html">http://webserver.docs.pivotal.io/doc/60/index.html#web-server/src/config.html</a></p>
<h3><strong>Pivotal RabbitMQ Server</strong></h3>
<p>The rabbitmq-management plugin provides an HTTP-based API for management and monitoring of your Pivotal RabbitMQ server. Hyperic’s RabbitMQ plugin manages RabbitMQ brokers, the virtual hosts within a broker, and RabbitMQ exchanges, queues, connections, and channels. The plugin can discover and manage multiple RabbitMQ nodes on the same platform as the Hyperic Agent.</p>
<p><a href="http://pubs.vmware.com/hyperic-58/topic/com.vmware.hyperic.resource.configuration.metrics.doc/GUID-B0E86A1F-90FE-4C64-86AD-F1610E6012D3.html">http://pubs.vmware.com/hyperic-58/topic/com.vmware.hyperic.resource.configuration.metrics.doc/GUID-B0E86A1F-90FE-4C64-86AD-F1610E6012D3.html</a></p>
<h2><strong>New Relic</strong></h2>
<p>New Relic provides real-time monitoring of Web applications on-premises or in the cloud. The NewRelic plugins provided by Pivotal gather metric data for App Suite products and display them in your New Relic dashboard. The plugins are available in a public GitHub repository located at <a href="https://github.com/gopivotal/newrelic_pivotal_agent">https://github.com/gopivotal/newrelic_pivotal_agent</a>. See the provided README for any usage notes. Monitoring for tc Server is available via NewRelic Java agent.</p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://blog.pivotal.io/pivotal/products/easy-pivotal-app-installs-rpm-deb-msi-brew-chef-puppet-and-more"> on September 05, 2014 09:15 PM</a></span>
		</div>
	</div><!-- .post -->

		<h3 id="todaysDate">August 21, 2014</h3>

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://blog.pivotal.io/pivotal-cloud-foundry/products/session-replication-on-cloud-foundry-2" title="Pivotal P.O.V. » Redis">Session Replication on Cloud Foundry</a></h2>

<h3>Pivotal</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><img alt="featured-polycloud-green" class="alignleft size-full wp-image-8488" height="200" src="http://blog.pivotal.io/wp-content/uploads/2014/05/featured-polycloud-green.png" width="200" />Recently, the Java Buildpack added support for <a href="https://github.com/cloudfoundry/java-buildpack/blob/master/docs/container-tomcat.md#session-replication" style="color: #0074bd;" target="_blank">session replication</a> using Redis. This support complements the existing session affinity (i.e. sticky sessions) that Cloud Foundry already supports. So now, in addition to having sessions routed to the instance they were created on, sessions will also survive the loss of that instance. The Java Buildpack will auto-configure Redis-based Session Replication for you when it notices that you’ve bound to a specially identified Redis service.</p>
<p>By default, the Tomcat instance provided by the Java Buildpack is <a href="https://github.com/cloudfoundry/java-buildpack/blob/master/docs/container-tomcat.md#configuration" style="color: #0074bd;" target="_blank">configured</a> to store all sessions and their data in memory. To make the instance use Redis-based Session Replication instead, bind a Redis service containing a <code>name</code>, <code>label</code>, or <code>tag</code> that has <code>session-replication</code> as a substring and the Java Buildpack will do the rest. <code>restage</code>ing your application will cause the required dependencies to be downloaded and configured.</p>
<p><code>$&gt; cf restage cfrost-session-application<br />
...<br />
-----&gt; Java Buildpack Version: 41ccef3 | https://github.com/cloudfoundry/java-buildpack.git#41ccef3<br />
-----&gt; Downloading Open Jdk JRE 1.7.0_65 from http://download.run.pivotal.io/openjdk/lucid/x86_64/openjdk-1.7.0_65.tar.gz (found in cache)<br />
Expanding Open Jdk JRE to .java-buildpack/open_jdk_jre (1.0s)<br />
-----&gt; Downloading Spring Auto Reconfiguration 1.4.0_RELEASE from http://download.run.pivotal.io/auto-reconfiguration/auto-reconfiguration-1.4.0_RELEASE.jar (found in cache)<br />
-----&gt; Downloading Tomcat Instance 7.0.54 from http://download.run.pivotal.io/tomcat/tomcat-7.0.54.tar.gz (found in cache)<br />
Expanding Tomcat to .java-buildpack/tomcat (0.1s)<br />
-----&gt; Downloading Tomcat Lifecycle Support 2.2.0_RELEASE from http://download.run.pivotal.io/tomcat-lifecycle-support/tomcat-lifecycle-support-2.2.0_RELEASE.jar (found in cache)<br />
-----&gt; Downloading Tomcat Logging Support 2.2.0_RELEASE from http://download.run.pivotal.io/tomcat-logging-support/tomcat-logging-support-2.2.0_RELEASE.jar (found in cache)<br />
-----&gt; Downloading Tomcat Access Logging Support 2.2.0_RELEASE from http://download.run.pivotal.io/tomcat-access-logging-support/tomcat-access-logging-support-2.2.0_RELEASE.jar (found in cache)<br />
-----&gt; Downloading Tomcat Redis Store 1.2.0_RELEASE from http://download.run.pivotal.io/redis-store/redis-store-1.2.0_RELEASE.jar (0.0s)<br />
Adding Redis-based Session Replication<br />
-----&gt; Uploading droplet (45M)<br />
1 of 1 instances running<br />
...<br />
App started</code></p>
<p>The console output shows that the Tomcat Redis Store is downloaded because your application is bound to a Redis service. Redis-based Session Replication is then added to the Tomcat instance because of the service’s name. You can verify the session persistence directly by exercising your application from a couple of different browsers and then using the <code>redis-cli</code> tool to inspect Redis.</p>
<p><code>$&gt; redis-cli keys *<br />
1) "A174CD1FC86066A01B78572DED1F9618"<br />
2) "D6B37E35788FCC50CD5B28FB68682735"<br />
3) "78CBE316C140C3528D0B6590A7CAC774"<br />
4) "AAEECAA96947C5EDBD9C967FCABE472C"<br />
5) "F189383702E2694552277EB1ACC3F1A5"<br />
6) "B8A7D7A229B063BB9E4A5F853BB95D9D"<br />
7) "25EF288A4552F24735CDCC78D169F776"</code></p>
<p>The Redis keys are the ids of the stored sessions. These sessions can be retrieved by any instance of your application. This means that if an instance of your application crashes or is restarted, any other live instance can pick up the session and the user won’t have to start again. You can try this for yourself with this <a href="https://github.com/nebhale/cfsummit-2014" style="color: #0074bd;" target="_blank">demo application</a> and a full walk-through in <a href="https://www.youtube.com/watch?v=hy_huSXghI8" style="color: #0074bd;" target="_blank">Ben Hale’s CF Summit 2014 talk</a> at 9 minutes in.</p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://blog.pivotal.io/pivotal-cloud-foundry/products/session-replication-on-cloud-foundry-2"> on August 21, 2014 05:24 PM</a></span>
		</div>
	</div><!-- .post -->

		<h3 id="todaysDate">June 06, 2014</h3>

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://blog.pivotal.io/pivotal-cloud-foundry/news-2/redislabs-now-available-in-pivotal-web-services-marketplace" title="Pivotal P.O.V. » Redis">RedisLabs Now Available in Pivotal Web Services Marketplace</a></h2>

<h3>Pivotal</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><i>The following is a guest blog post by <a href="https://twitter.com/itamarhaber">Itamar Haber</a>, Chief Developers Advocate at </i><a href="https://redislabs.com/"><i>Redis Labs</i></a><i>, a provider of enterprise-class Redis for developers.</i></p>
<p>Redis Cloud is a fully-managed cloud service for hosting and running Redis datasets. The service provides developers with a highly-available, scalable and performant database-as-a-service that is ideally suited to scalable web and mobile app. For Cloud Foundry developers building and hosting apps on Pivotal Web Services, you can now add Redis Cloud to your apps directly from the Services Marketplace.</p>
<h2>Web Console</h2>
<p><a href="https://console.run.pivotal.io/marketplace" target="_blank"><img alt="RedisBlog - Image 1" class="alignnone size-full wp-image-9067" height="637" src="http://blog.gopivotal.com/wp-content/uploads/2014/06/RedisBlog-Image-12.png" width="1078" /></a></p>
<p>Click on the Redis Cloud service to see the Plan Selection page:</p>
<p><a href="https://console.run.pivotal.io/marketplace/rediscloud" target="_blank"><img alt="RedisBlog - Image 2" class="alignnone size-full wp-image-9068" height="671" src="http://blog.gopivotal.com/wp-content/uploads/2014/06/RedisBlog-Image-22.png" width="899" /></a></p>
<p>Choose a plan to start with (I recommend starting with the Free 25MB plan) and select the ‘BUY THIS PLAN’ button to create the service instance. You can also choose to bind it to a specific application. If you aren’t ready to bind the RedisDB to your app right now, you can always bind it later from the application dashboard or through the command line interface (CLI).</p>
<p><img alt="RedisBlog - Image 3" class="alignnone size-full wp-image-9069" height="629" src="http://blog.gopivotal.com/wp-content/uploads/2014/06/RedisBlog-Image-32.png" width="1060" /></p>
<p><span style="font-size: 1.5em;">Command Line Interface</span></p>
<p>If you’re more inclined to use the command line interface, here are the steps:</p>
<p>First, create the service:</p>
<p><code>$ cf create-service rediscloud PLAN_NAME INSTANCE_NAME</code></p>
<p>Where <code>PLAN_NAME</code> is the plan you want to use and <code>INSTANCE_NAME</code> is the name you want to use for the service. Once the service’s instance is created, bind it to your application with the following command:</p>
<p><code>$ cf bind-service APP_NAME INSTANCE_NAME<br />
</code></p>
<p>Where <code>APP_NAME</code> is the name of the application that the service will be bound to.</p>
<p>That’s all there is to it—your first database will be created automatically, and your app will now be able to use Redis Cloud. You can obtain the immutable endpoint (hostname and port) of your Redis Cloud database by fetching the contents of your app’s <code>VCAP_SERVICE</code>S environment variable, or from the service’s management console (click the ‘MANAGE’ link in under the Redis Cloud service). Depending on the plan you purchased, you can also use the management console to edit the properties of your database.</p>
<p>Redis Cloud is fully compliant with the open source Redis project, so all you need to do is point your application to your Redis Cloud endpoint and you’re good to go. For example, if you’re using Ruby, create an intializer file (e.g. config/initializers/redis.rb) with the following content:</p>
<blockquote><p>rediscloud_service = JSON.parse(ENV[‘VCAP_SERVICES’])[“rediscloud-n/a”]</p>
<p>credentials = rediscloud_service.first[“credentials”]</p>
<p>$redis = Redis.new(:host =&gt; credentials[“hostname”], :port =&gt; credentials[“port”], :password =&gt; credentials[“password”])</p></blockquote>
<p>That’s all that’s needed to get you started so you can focus on developing your application instead of worrying about things like:</p>
<ul>
<li>node failures (our service boasts automatic and transparent failover),</li>
<li>scaling up or down (that’s done seamlessly, instantly and without interruption to the service),</li>
<li>data persistence (included free of charge),</li>
<li>daily and on-demand backups (also included), or</li>
<li>any other operational aspect regarding your Redis database.</li>
</ul>
<p>If you need any help, have questions or feedback—feel free to contact Itamar via <a href="mailto:itamar@redislabs.com">email</a> or <a href="https://twitter.com/@itamarhaber">Twitter</a>. For support questions, send an email to <a href="mailto:support@redislabs.com">support@redislabs.com</a>. Happy coding!</p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://blog.pivotal.io/pivotal-cloud-foundry/news-2/redislabs-now-available-in-pivotal-web-services-marketplace"> on June 06, 2014 06:13 PM</a></span>
		</div>
	</div><!-- .post -->

		<h3 id="todaysDate">December 03, 2013</h3>

	<div class="hentry post">
		<div class="postHeader">
	<img class="face" src="images/nobody.png" alt="">

			<h2 class="entry-title"><a href="http://blog.pivotal.io/pivotal/news-2/pivotal-offering-redis-support-redis-2-8-0-now-available" title="Pivotal P.O.V. » Redis">Pivotal Offering Redis Support + Redis 2.8.0 Now Available</a></h2>

<h3>Pivotal</h3>

			<div class="clearBoth"></div>
		</div>
		<div class="entry-content">
<p><a href="http://download.redis.io/releases/redis-2.8.1.tar.gz" target="_blank"><img alt="cta-download-redis" class="alignleft size-full wp-image-5566" height="200" src="http://blog.gopivotal.com/wp-content/uploads/2013/12/cta-download-redis.jpg" width="200" /></a>Earlier this year, we published a <a href="http://blog.gopivotal.com/pivotal-people/pivotal-people-salvatore-sanfilippo-inventor-of-redis" target="_blank" title="Pivotal People Salvatore Sanfillipo">story on one of our Pivotal People, Salvatore Sanfillipo</a>, the inventor of <a href="http://redis.io/" target="_blank" title="Redis">Redis</a>. First released in 2009, Redis is a popular open source in-memory data cache, with over a million users worldwide. It is used to speed up data in many of the most popular web applications that deal with huge data volumes, including Twitter, Yahoo, LinkedIn, and Pinterest.</p>
<p>Savvy readers noticed Pivotal was becoming a hot bed for Redis knowledge and development, and today we are happy to extend that competency out to commercial support offerings. As of today, Pivotal will be offering 2 types of services for companies that have grown to depend on Redis and would like commercial support.</p>
<ul>
<li><span style="line-height: 13px;"><strong>Developer Support.</strong> Priced per developer, this support is designed to support developers as they build out and support their own systems. Support is available for 12 hours a day, 5 days a week and is valid for one year.</span></li>
<li><strong>Production Support.</strong> Priced per CPU, this support is the type of round-the-clock support that is needed for customer facing apps companies use to run their business.</li>
</ul>
<p>To request support, <a href="http://www.gopivotal.com/contact" target="_blank" title="Contact Pivotal">contact Pivotal via our website</a> or email us at <strong>redis@gopivotal.com</strong>.</p>
<h3><strong>Redis 2.8.0 Now Available</strong></h3>
<p>In addition, after nearly a year of development, and weeks without a serious bug being reported for the public beta, <a href="https://groups.google.com/forum/#!topic/redis-db/37xgI268Nh8" target="_blank" title="Redis 2.8.0 Now Available">Redis 2.8.0 has been released as stable code</a>.</p>
<p>With nearly 1000 commits to the now stable branch, many things are improved in the latest version, including:</p>
<ul>
<li>Partial resynchronization with slaves. It is no longer needed to transfer all the data set from the master to the slave if the link is interrupted for a short time. <a href="http://antirez.com/news/47" target="_blank" title="Partial resynchronization with Redis">&gt;&gt; More</a><a href="http://www.google.com/url?q=http%3A%2F%2Fantirez.com%2Fnews%2F47&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFVMoAzEYCVzbRPBle7ZoptdtGo3w" target="_blank"><br />
</a></li>
<li>Redis collections are now iterable with SCAN / HSCAN / ZSCAN / SSCAN. <a href="http://antirez.com/news/63" target="_blank" title="Redis collections are iterable">&gt;&gt; More</a></li>
<li>The CONFIG module was re-written to allow config changes sent directly to instances to be propagated to the server in order to preserve how the server works after a reboot. <a href="http://antirez.com/news/54" target="_blank" title="Redis CONFIG rewrite">&gt;&gt; More</a></li>
<li>IPv6 support.</li>
<li>Scripting improvements (EVALSHA replication).</li>
<li>Better key expiring algorithm.</li>
<li>Keyspace events notification via Pub/Sub.<a href="http://redis.io/topics/notifications" target="_blank" title="Keyspace notifications"> &gt;&gt; More</a></li>
<li>Better consistency support with the ability to stop writes if there are not at least N slaves that are not lagged more than M milliseconds.</li>
<li>A number of additional small features and bugs fixed.</li>
</ul>
<p><a href="http://www.gopivotal.com/big-data/redis" target="_blank"><img alt="Pivotal-Blog-CTA-Redis" class="alignnone size-full wp-image-6690" height="135" src="http://blog.gopivotal.com/wp-content/uploads/2013/12/Pivotal-Blog-CTA-Redis.jpg" width="600" /></a></p>
<h4><strong>About the Sentinel Re-write</strong></h4>
<p><a href="http://redis.io/topics/sentinel" target="_blank" title="Redis Sentinel">Redis Sentinel</a>, the management system dedicated to Redis, was rewritten from scratch to be more reliable. The new version is available to work with Redis 2.8.0, however it must be downloaded from the unstable branch.</p>
<h4><strong>Upgrading</strong></h4>
<p>For companies with Redis installed, it is recommended that you consider the list of features and improvements for Redis 2.8.0 and establish a plan to upgrade when it fits the needs of the business. While upgrades are encouraged, previous versions are stable and can continue to support your projects. However, given the degree of revisions and improvements for Sentinel, it is recommended that users upgrade Sentinel to the new version as soon as possible.</p>			<div class="clearBoth"></div>
		</div>
		<div class="entry-utility">
			<span class="cat-links"><a href="http://blog.pivotal.io/pivotal/news-2/pivotal-offering-redis-support-redis-2-8-0-now-available"> on December 03, 2013 05:35 PM</a></span>
		</div>
	</div><!-- .post -->

			</div><!-- #content -->
		</div><!-- #container -->

		<div id="secondary" class="aside main-aside">
			<ul class="xoxo">
				<li class="widgetcontainer widget_text">
          <h3 class="widgettitle">About the Community Redis Blog Aggregator</h3>
					<p>This website is a community-maintained and inclusive feed of Redis-related blog posts. To add your blog's feed, please fork <a href="https://github.com/xaprb/planetredis">the repository</a>, modify the config.ini file to add your feed at the end, and submit a pull request.</p>
				</li>
				<li class="widgetcontainer widget_extended-categories">
					<h3 class="widgettitle">Feeds</h3>
					<ul>
						<li>
							<a href="http://antirez.com/rss" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)" /></a> <a href="http://antirez.com" title="Antirez weblog">Antirez</a>
						</li>
						<li>
							<a href="http://blog.pivotal.io/tag/redis/feed" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)" /></a> <a href="http://blog.pivotal.io" title="Pivotal P.O.V. » Redis">Pivotal</a>
						</li>
						<li>
							<a href="https://redislabs.com/feed" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)" /></a> <a href="https://redislabs.com" title="Redis Labs">Redis Labs</a>
						</li>
						<li>
							<a href="https://vividcortex.com/index.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)" /></a> <a href="https://vividcortex.com/" title="VividCortex">Vivid Cortex</a>
						</li>
					</ul>
				</li>
			</ul>
		</div><!-- #secondary .aside -->
		<div class="clearBoth"></div>
	</div><!-- #main -->
</div><!-- #wrapper .hfeed -->

<div id="footer">
	<div id="siteinfo">
		<p>
      &copy; <a href="https://vividcortex.com/">VividCortex</a><br />
			Blog entries aggregated on this page are owned by, and represent the opinion of the author. Header image courtesy of <a href="https://www.flickr.com/photos/will_spark/8602965477">will_spark</a> on Flickr, CC-licensed. Theme/template derived from Planet Ubuntu's. Powered by <a href="http://planetplanet.org">Planet Planet</a>.<br />
		</p>
	</div><!-- #siteinfo -->
</div><!-- #footer -->
</body>
</html>
